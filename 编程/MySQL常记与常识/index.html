<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/time.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/time.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/time.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="速查,MySQL,笔记,数据库," />










<meta name="description" content="一份精要的，不失细节的MySQL命令常识与技巧">
<meta name="keywords" content="速查,MySQL,笔记,数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL常记与常识">
<meta property="og:url" content="http://yoursite.com/编程/MySQL常记与常识/index.html">
<meta property="og:site_name" content="Snowman Home">
<meta property="og:description" content="一份精要的，不失细节的MySQL命令常识与技巧">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-03-02T06:40:00.501Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL常记与常识">
<meta name="twitter:description" content="一份精要的，不失细节的MySQL命令常识与技巧">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/编程/MySQL常记与常识/"/>





  <title>MySQL常记与常识 | Snowman Home</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?7cfc0c698314e244e85d1f8a38545357";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Snowman Home</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">谢塞上风雪，谢人动如烟</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-life">
          <a href="/categories/生活" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heart"></i> <br />
            
            生活
          </a>
        </li>
      
        
        <li class="menu-item menu-item-code">
          <a href="/categories/编程" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-code"></i> <br />
            
            编程
          </a>
        </li>
      
        
        <li class="menu-item menu-item-finance">
          <a href="/categories/金融" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-money"></i> <br />
            
            金融
          </a>
        </li>
      
        
        <li class="menu-item menu-item-world">
          <a href="/categories/人间纵横" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-globe"></i> <br />
            
            人间纵横
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/编程/MySQL常记与常识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Snowman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/timeaftertime.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Snowman Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MySQL常记与常识</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-27T19:44:37+08:00">
                2018-02-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>一份精要的，不失细节的MySQL命令常识与技巧</p>
<a id="more"></a>
<h2 id="系统操作"><a href="#系统操作" class="headerlink" title="系统操作"></a>系统操作</h2><h3 id="在DOS环境下设置root密码"><a href="#在DOS环境下设置root密码" class="headerlink" title="在DOS环境下设置root密码"></a>在DOS环境下设置root密码</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">D:\software\mysql-5.6.25-winx64\bin&gt;mysqladmin -u root password "123456";</div></pre></td></tr></table></figure>
<h3 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">D:\software\mysql-5.6.25-winx64\bin&gt; mysql -u root -p</div><div class="line">Enter password: ******</div></pre></td></tr></table></figure>
<h3 id="关闭服务"><a href="#关闭服务" class="headerlink" title="关闭服务"></a>关闭服务</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">D:\software\mysql-5.6.25-winx64\bin&gt;mysqladmin -u root -p shutdown</div><div class="line">Enter password: ******</div></pre></td></tr></table></figure>
<h3 id="验证版本"><a href="#验证版本" class="headerlink" title="验证版本"></a>验证版本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">D:\software\mysql-5.6.25-winx64\bin&gt; mysqladmin --version</div><div class="line">mysqladmin  Ver 8.42 Distrib 5.7.17, for Win64 on x86_64</div></pre></td></tr></table></figure>
<h2 id="管理操作"><a href="#管理操作" class="headerlink" title="管理操作"></a>管理操作</h2><h3 id="设置MySQL用户账户"><a href="#设置MySQL用户账户" class="headerlink" title="设置MySQL用户账户"></a>设置MySQL用户账户</h3><p>要添加一个新用户到MySQL,只需要在mysql.user表中添加新纪录即可。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">mysql&gt; use mysql;</div><div class="line">Database changed</div><div class="line"></div><div class="line">mysql&gt; INSERT INTO user </div><div class="line">          (host, user, password, </div><div class="line">           select_priv, insert_priv, update_priv) </div><div class="line">           VALUES ('localhost', 'yiibai', </div><div class="line">           PASSWORD('123456'), 'Y', 'Y', 'Y');</div><div class="line">Query OK, 1 row affected (0.20 sec)</div><div class="line"></div><div class="line">mysql&gt; FLUSH PRIVILEGES;</div><div class="line">Query OK, 1 row affected (0.01 sec)</div><div class="line"></div><div class="line">mysql&gt; SELECT host, user, password FROM user WHERE user = 'yiibai';</div><div class="line">+<span class="comment">-----------+---------+------------------+</span></div><div class="line">| host      | user    | password         |</div><div class="line">+<span class="comment">-----------+---------+------------------+</span></div><div class="line">| localhost | yiibai | *59A8740AAC5DBCB2907F38891BE42957F699CB77 |</div><div class="line">+<span class="comment">-----------+---------+------------------+</span></div><div class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure>
<ul>
<li>PASSWORD()是加密函数</li>
<li>FLUSH PRIVILEGES为重新加载授权表。</li>
<li>可以通过在INSERT新用户时以下几列的值为Y，指定给用户相应权限，也可以使用UPDATE更新它们。<ul>
<li>Select_priv</li>
<li>Insert_priv</li>
<li>Update_priv</li>
<li>Delete_priv</li>
<li>Create_priv</li>
<li>Drop_priv</li>
<li>Reload_priv</li>
<li>Shutdown_priv</li>
<li>Process_priv</li>
<li>File_priv</li>
<li>Grant_priv</li>
<li>References_priv</li>
<li>Index_priv</li>
<li>Alter_priv</li>
</ul>
</li>
</ul>
<h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><p>创建一个新的数据库tutorials</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt;create database tutorials default character set utf8 collate utf8_general_ci;</div></pre></td></tr></table></figure>
<p>也可以在DOS下直接使用mysqladmin进行操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Program Files\MySQL\MySQL Server 5.7\bin&gt;mysqladmin -u root -p create tutorials1</div><div class="line">Enter password: ******</div></pre></td></tr></table></figure>
<h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><p>删除数据库同理</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">D:\software\mysql-5.6.25-winx64\bin&gt; mysqladmin -u root -p drop yiibai_tutorials1</div><div class="line">Enter password:******</div><div class="line"></div><div class="line">mysql&gt; drop database yiibai_tutorials1;</div></pre></td></tr></table></figure>
<h4 id="另一种创建用户的方式-GRANT"><a href="#另一种创建用户的方式-GRANT" class="headerlink" title="另一种创建用户的方式 GRANT"></a>另一种创建用户的方式 GRANT</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">mysql&gt; use mysql;</div><div class="line">Database changed</div><div class="line"></div><div class="line">mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP</div><div class="line">    -&gt; ON tutorials.*</div><div class="line">    -&gt; TO 'yiibai'@'localhost'</div><div class="line">    -&gt; IDENTIFIED BY '123456';</div></pre></td></tr></table></figure>
<p>这会创建一个新用户yiibai，并且只在数据库tutorials上有作用。</p>
<h3 id="一些常用的查看操作"><a href="#一些常用的查看操作" class="headerlink" title="一些常用的查看操作"></a>一些常用的查看操作</h3><ul>
<li>USE Databasename : 用于选择在MySQL工作区指定的数据库。</li>
<li>SHOW DATABASES: 列出了MySQL数据库管理系统中的所有可访问的数据库。</li>
<li>SHOW TABLES: 显示已经选择数据库中的表的命令。</li>
<li>SHOW COLUMNS FROM tablename: 显示属性，属性类型，关键信息，NULL是否被允许，默认值和其它的表信息。</li>
<li>SHOW INDEX FROM tablename: 提供所有指标的详细信息表，其中包括PRIMARY KEY.</li>
<li>SHOW TABLE STATUS LIKE tablename\G: 报告MySQL的数据库管理系统的性能和统计数据的详细信息。</li>
<li>SHOW PROCESSLIST 查看当前进程</li>
</ul>
<h2 id="表字段类型"><a href="#表字段类型" class="headerlink" title="表字段类型"></a>表字段类型</h2><p>MySQL使用许多不同的数据类型，总体上分为三类，数字，日期，时间和字符串类型。</p>
<ul>
<li>它用来表示数据值。</li>
<li>占用的空间以及值是固定长度还是可变长度。</li>
<li>数据类型的值可以被索引。</li>
<li>MySQL如何比较特定数据类型的值。</li>
</ul>
<ul>
<li>数字<ul>
<li>INT 无符号范围0-2^32。有符号范围-2^31 ~ 2^31。容量为4个字节</li>
<li>TINYINT 无符号范围0-2^8。有符号范围-2^7 ~ 2^7。容量为1个字节</li>
<li>SMALLINT 无符号范围0-2^16。有符号范围-2^15 ~ 2^15。容量为2个字节</li>
<li>MEDIUM 无符号范围0-2^24。有符号范围-2^23 ~ 2^23。容量为3个字节</li>
<li>BIGINT 无符号范围0-2^64。有符号范围-2^63 ~ 2^63。容量为8个字节</li>
<li>FLOAT(M,D) 有符号浮点型，M是数字总数，D是小数位数，小数精度可达24个浮点，MD默认为10，2，可定义。</li>
<li>DOUBLE(M,D) 有符号浮点型，M是数字总数，D是小数位数，小数精度可达53个浮点，MD默认为16，4，可定义。</li>
<li>DECIMAL(M,D) 有符号非压缩浮点数。每个小数耗费一个字节，M,D是必须指定的。</li>
</ul>
</li>
<li>日期和时间<ul>
<li>DATE 以YYYY-MM-DD格式的日期，在1000-01-01和9999-12-31之间。 例如，1973年12月30日将被存储为1973-12-30。</li>
<li>DATETIME - 日期和时间组合以YYYY-MM-DD HH:MM:SS格式，在1000-01-01 00:00:00 到9999-12-31 23:59:59之间。例如，1973年12月30日下午3:30，会被存储为1973-12-30 15:30:00。</li>
<li>TIMESTAMP 1970年1月1日午夜之间的时间戳，到2037的某个时候。这看起来像前面的DATETIME格式，无需只是数字之间的连字符; 1973年12月30日下午3点30分将被存储为19731230153000(YYYYMMDDHHMMSS)。</li>
<li>TIME 存储时间在HH:MM:SS格式。</li>
<li>YEAR(M) - 以2位或4位数字格式来存储年份。如果长度指定为2(例如YEAR(2))，年份就可以为1970至2069(70〜69)。如果长度指定为4，年份范围是1901-2155，默认长度为4。(可以明显发现，以year形式存储的时间，其实所占空间更小。)</li>
</ul>
</li>
<li>字符串<ul>
<li>CHAR(M) 固定长度字符串，M为长度，默认为1 ，不足者空格填充至指定长度</li>
<li>VARCHAR(M) 可变长度字符串，M为最大长度，必须定义。</li>
<li>BLOB or TEXT 字段最大长度65535(2^16)，BLOB是二进制大对象，用以存储大的二进制数据，如图像。BLOB大小写敏感，TEXT不敏感。</li>
<li>TINYBLOB or TINYTEXT 最大长度255个字符。</li>
<li>MEDIUMBLOB or MEDIUMTEXT 最大长度16777215字符。</li>
<li>ENUM 枚举，即多项选择，ENUM(‘A’,’B’,’C’)表示只有这三个字符可以用来填充该字段。</li>
</ul>
</li>
</ul>
<h2 id="查询表"><a href="#查询表" class="headerlink" title="查询表"></a>查询表</h2><p>在从表中查询数据时，可能会收到重复的行记录，为了删除这些重复行，可以在SELECT中使用DISTINCT子句</p>
<p>语法如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></div><div class="line">    <span class="keyword">columns</span></div><div class="line"><span class="keyword">FROM</span></div><div class="line">    table_name</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    where_conditions;</div></pre></td></tr></table></figure>
<p>则在查询结果中，自然被消除。</p>
<p>如果列具有NULL值，则只保留一个NULL值，因为DISTINCT子句将所有NULL值视为相同的值。</p>
<p>DISTINCT支持多列查询，并且只删去联合重复。</p>
<h3 id="DISTINCE-和-GROUP-BY比较"><a href="#DISTINCE-和-GROUP-BY比较" class="headerlink" title="DISTINCE 和 GROUP BY比较"></a>DISTINCE 和 GROUP BY比较</h3><p>以下两种命令效果相同</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT DISTINCT state FROM customers;</div><div class="line">mysql&gt; SELECT  state FROM customers GROUP BY state;</div></pre></td></tr></table></figure>
<p>DISTINCE 是 GROUP BY的特殊情况，之间的区别是GROUP BY子句可对结果集进行排序，而DISTINCT不进行排序</p>
<p>如果将ORDER BY添加到使用DISTINCT子句的语句中，则效果与GROUP BY子句效果一样</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></div><div class="line">    state</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    customers</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> state;</div></pre></td></tr></table></figure>
<h3 id="DISTINCT和聚合函数"><a href="#DISTINCT和聚合函数" class="headerlink" title="DISTINCT和聚合函数"></a>DISTINCT和聚合函数</h3><p>可以在聚合函数(例如SUM AVG COUNT)中应用DISTINCT子句，求得相应值。如下要计算美国客户的state个数，可以使用以下查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> state)</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    customers</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    country = <span class="string">'USA'</span>;</div><div class="line"></div><div class="line">mysql&gt; SELECT  COUNT(DISTINCT state) FROM customers WHERE country = 'USA';</div><div class="line">+<span class="comment">-----------------------+</span></div><div class="line">| COUNT(DISTINCT state) |</div><div class="line">+<span class="comment">-----------------------+</span></div><div class="line">|                     8 |</div><div class="line">+<span class="comment">-----------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure>
<h3 id="DISTINCT-与-LIMIT子句"><a href="#DISTINCT-与-LIMIT子句" class="headerlink" title="DISTINCT 与 LIMIT子句"></a>DISTINCT 与 LIMIT子句</h3><p>以下查询customers表中的前3个非空(NOT NULL)唯一state列的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT DISTINCT state FROM customers WHERE state IS NOT NULL LIMIT 3;</div><div class="line">+<span class="comment">----------+</span></div><div class="line">| state    |</div><div class="line">+<span class="comment">----------+</span></div><div class="line">| NV       |</div><div class="line">| Victoria |</div><div class="line">| CA       |</div><div class="line">+<span class="comment">----------+</span></div><div class="line">3 rows in <span class="keyword">set</span></div></pre></td></tr></table></figure>
<h2 id="创建、删除及插入表"><a href="#创建、删除及插入表" class="headerlink" title="创建、删除及插入表"></a>创建、删除及插入表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">通用语法</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name (column_name column_type);</div><div class="line"></div><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> tutorials_tbl(</div><div class="line">   tutorial_id <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</div><div class="line">   tutorial_title <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">   tutorial_author <span class="built_in">VARCHAR</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">   submission_date <span class="built_in">DATE</span>,</div><div class="line">   PRIMARY <span class="keyword">KEY</span> ( tutorial_id )</div><div class="line">);</div></pre></td></tr></table></figure>
<ul>
<li>字段使用NOT NULL属性，是因为我们不希望这个字段的值为NULL。 因此，如果用户将尝试创建具有NULL值的记录，那么MySQL会产生错误。</li>
<li>字段的AUTO_INCREMENT属性告诉MySQL自动增加id字段下一个可用编号。</li>
<li>关键字PRIMARY KEY用于定义此列作为主键。可以使用逗号分隔多个列来定义主键。</li>
</ul>
<p>删除表更加简单，和删除数据库类似。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; DROP TABLE tutorials_tbl;</div></pre></td></tr></table></figure>
<p>添加新记录方法如下</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">通用语法 </div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name ( field1, field2,...fieldN )</div><div class="line">                       <span class="keyword">VALUES</span></div><div class="line">                       ( value1, value2,...valueN );</div><div class="line"></div><div class="line">mysql&gt; INSERT INTO tutorials_tbl</div><div class="line">     -&gt;(tutorial_title, tutorial_author, submission_date)</div><div class="line">     -&gt;VALUES</div><div class="line">     -&gt;("Learn MySQL", "Saya", NOW());</div></pre></td></tr></table></figure>
<p>在上面的例子中，未提供 tutorial_id 对应的值，因为在创建表时它会自动创建，这个字段我们给了AUTO_INCREMENT选项。因此MySQL会自动分配插入ID的值。 这里, NOW() 是MySQL函数，返回当前的日期和时间。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">通用语法</div><div class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN table_name1, table_name2...</div><div class="line">[<span class="keyword">WHERE</span> Clause]</div><div class="line">[<span class="keyword">OFFSET</span> M ][<span class="keyword">LIMIT</span> N]</div></pre></td></tr></table></figure>
<ul>
<li>可以使用分隔的一个或多个逗号从多个表，以及使用WHERE子句包括各种条件，但WHERE子句是SELECT命令的可选部分</li>
<li>可以在一个SELECT命令指定读取一个或多个字段</li>
<li>可以指定星号(*)代替选择的字段。在这种情况下，将返回所有字段</li>
<li>可以指定任意的条件在 WHERE 子句后面</li>
<li>可以使用OFFSET指定一个偏移量，SELECT从那里开始返回记录。默认情况下 offset 的值是 0</li>
<li>可以使用LIMIT属性限制返回的数量</li>
</ul>
<h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><p><strong>插入多行</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span>(column1,column2...)</div><div class="line"><span class="keyword">VALUES</span> (value1,value2,...),</div><div class="line">       (value1,value2,...),</div><div class="line">...;</div></pre></td></tr></table></figure>
<p>为表中的所有列指定相应列的值，则可以忽略INSERT语句中的列列表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span></div><div class="line"><span class="keyword">VALUES</span> (value1,value2,...);</div></pre></td></tr></table></figure>
<h3 id="INSERT-…-SELECT"><a href="#INSERT-…-SELECT" class="headerlink" title="INSERT … SELECT"></a>INSERT … SELECT</h3><p>使用该方法，以从某个表中完全或部分复制内容。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_1 <span class="keyword">LIKE</span> table_2;</div><div class="line"></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_1</div><div class="line"><span class="keyword">SELECT</span> c1, c2, <span class="keyword">FROM</span> table_2;</div></pre></td></tr></table></figure>
<h3 id="INSERT与ON-DUPLICATE-KEY-UPDATE"><a href="#INSERT与ON-DUPLICATE-KEY-UPDATE" class="headerlink" title="INSERT与ON DUPLICATE KEY UPDATE"></a>INSERT与ON DUPLICATE KEY UPDATE</h3><p>如果在INSERT语句中指定ON DUPLICATE KEY UPDATE选项，MySQL将插入新行或使用新值更新原行记录。</p>
<p>下方语句将task_id = 4 的行更新为task_id = 5。subject = …</p>
<p>该方法与UPDATE语句等效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tasks(task_id,subject,start_date,end_date,description)</div><div class="line"><span class="keyword">VALUES</span> (<span class="number">4</span>,<span class="string">'Test ON DUPLICATE KEY UPDATE'</span>,<span class="string">'2017-01-01'</span>,<span class="string">'2017-01-02'</span>,<span class="string">'Next Priority'</span>)</div><div class="line"><span class="keyword">ON</span> <span class="keyword">DUPLICATE</span> <span class="keyword">KEY</span> <span class="keyword">UPDATE</span> </div><div class="line">   task_id = task_id + <span class="number">1</span>, </div><div class="line">   subject = <span class="string">'Test ON DUPLICATE KEY UPDATE'</span>;</div><div class="line"></div><div class="line"><span class="keyword">UPDATE</span> tasks </div><div class="line"><span class="keyword">SET</span> </div><div class="line">    task_id = task_id + <span class="number">1</span>,</div><div class="line">    subject = <span class="string">'Test ON DUPLICATE KEY UPDATE'</span></div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    task_id = <span class="number">4</span>;</div></pre></td></tr></table></figure>
<h3 id="MySQL-扩展：-IGNORE"><a href="#MySQL-扩展：-IGNORE" class="headerlink" title="MySQL 扩展： IGNORE"></a>MySQL 扩展： IGNORE</h3><p>在 INSERT 后加入 IGNORE 可以对报错进行保留，不立即终止命令执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">IGNORE</span> <span class="keyword">INTO</span> <span class="keyword">table</span>(column_list)</div><div class="line"><span class="keyword">VALUES</span>( value_list),</div><div class="line">      ( value_list),</div><div class="line">      ...</div></pre></td></tr></table></figure>
<h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><p>我们使用UPDATE语句来更新表中的现有数据。也可以使用UPDATE语句来更改表中单个行，一组行或所有行的列值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> [<span class="keyword">LOW_PRIORITY</span>] [<span class="keyword">IGNORE</span>] table_name </div><div class="line"><span class="keyword">SET</span> </div><div class="line">    column_name1 = expr1,</div><div class="line">    column_name2 = expr2,</div><div class="line">    ...</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    condition;</div></pre></td></tr></table></figure>
<blockquote>
<p>注意事项</p>
</blockquote>
<ul>
<li>首先，在UPDATE关键字后面指定要更新数据的表名。</li>
<li>其次，SET子句指定要修改的列和新值。要更新多个列，请使用以逗号分隔的列表。以字面值，表达式或子查询的形式在每列的赋值中来提供要设置的值。</li>
<li>第三，使用WHERE子句中的条件指定要更新的行。WHERE子句是可选的。 如果省略WHERE子句，则UPDATE语句将更新表中的所有行。</li>
<li>LOW_PRIORITY修饰符指示UPDATE语句延迟更新，直到没有从表中读取数据的连接。 LOW_PRIORITY对仅使用表级锁定的存储引擎(例如MyISAM，MERGE，MEMORY)生效。</li>
</ul>
<h3 id="UPDATE-与-SELECT-结合"><a href="#UPDATE-与-SELECT-结合" class="headerlink" title="UPDATE 与 SELECT 结合"></a><strong>UPDATE 与 SELECT 结合</strong></h3><p>在下方例子中，子查询首先从employeeNumber中随机找到一名销售经理，然后返回给母查询，最后将salesRepEmployeeNumber全部填充完毕，使得表customers不存在salesRepEmployeeNumber为空的情况。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> customers </div><div class="line"><span class="keyword">SET</span> </div><div class="line">    salesRepEmployeeNumber = (<span class="keyword">SELECT</span> </div><div class="line">            employeeNumber</div><div class="line">        <span class="keyword">FROM</span></div><div class="line">            employees</div><div class="line">        <span class="keyword">WHERE</span></div><div class="line">            jobtitle = <span class="string">'Sales Rep'</span></div><div class="line">        <span class="keyword">LIMIT</span> <span class="number">1</span>)</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    salesRepEmployeeNumber <span class="keyword">IS</span> <span class="literal">NULL</span>;</div></pre></td></tr></table></figure>
<h3 id="UPDATE-跨表更新-INNER-JOIN子句和LEFT-JOIN子句"><a href="#UPDATE-跨表更新-INNER-JOIN子句和LEFT-JOIN子句" class="headerlink" title="UPDATE 跨表更新(INNER JOIN子句和LEFT JOIN子句)"></a>UPDATE 跨表更新(INNER JOIN子句和LEFT JOIN子句)</h3><p>语法格式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> T1, T2,</div><div class="line">[<span class="keyword">INNER</span> <span class="keyword">JOIN</span> | <span class="keyword">LEFT</span> <span class="keyword">JOIN</span>] T1 <span class="keyword">ON</span> T1.C1 = T2. C1</div><div class="line"><span class="keyword">SET</span> T1.C2 = T2.C2, </div><div class="line">    T2.C3 = expr</div><div class="line"><span class="keyword">WHERE</span> condition</div></pre></td></tr></table></figure>
<p>在这个UPDATE语句与 <strong>具有隐式INNER JOIN子句的UPDATE JOIN</strong>工作相同。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">UPDATE</span> T1, T2</div><div class="line"><span class="keyword">SET</span> T1.c2 = T2.c2,</div><div class="line">      T2.c3 = expr</div><div class="line"><span class="keyword">WHERE</span> T1.c1 = T2.c1 <span class="keyword">AND</span> condition</div><div class="line"></div><div class="line"><span class="keyword">UPDATE</span> T1,T2</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> T2 <span class="keyword">ON</span> T1.C1 = T2.C1</div><div class="line"><span class="keyword">SET</span> T1.C2 = T2.C2,</div><div class="line">      T2.C3 = expr</div><div class="line"><span class="keyword">WHERE</span> condition</div></pre></td></tr></table></figure>
<h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><p>DELETE是删除表中观测值的命令，它可以删除全部观测值也可以删除单个观测值，</p>
<p>ORDER BY、LIMIT、WHERE等子句均可使用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> c1, c2, ...</div><div class="line"><span class="keyword">LIMIT</span> <span class="keyword">row_count</span>;</div></pre></td></tr></table></figure>
<h3 id="DELETE-与-INNER-JOIN"><a href="#DELETE-与-INNER-JOIN" class="headerlink" title="DELETE 与 INNER JOIN"></a>DELETE 与 INNER JOIN</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DELETE</span> T1, T2</div><div class="line"><span class="keyword">FROM</span> T1</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> T2 <span class="keyword">ON</span> T1.key = T2.key</div><div class="line"><span class="keyword">WHERE</span> condition</div></pre></td></tr></table></figure>
<p>请注意，将T1和T2表放在DELETE和FROM关键字之间。如果省略T1表，DELETE语句仅删除T2表中的行记录。 同样，如果省略了T2表，DELETE语句将只删除T1表中的行记录。</p>
<p>表达式T1.key = T2.key指定了将被删除的T1和T2表之间的匹配行记录的条件。</p>
<p>WHERE子句中的条件确定T1和T2表中要被删除的行记录。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">USE</span> testdb;</div><div class="line"></div><div class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> t1, t2;</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1 (</div><div class="line">    <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t2 (</div><div class="line">    <span class="keyword">id</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) PRIMARY <span class="keyword">KEY</span>,</div><div class="line"> <span class="keyword">ref</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t1 <span class="keyword">VALUES</span> (<span class="number">1</span>),(<span class="number">2</span>),(<span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t2(<span class="keyword">ref</span>) <span class="keyword">VALUES</span>(<span class="string">'A'</span>,<span class="number">1</span>),(<span class="string">'B'</span>,<span class="number">2</span>),(<span class="string">'C'</span>,<span class="number">3</span>);</div><div class="line"></div><div class="line">#以下语句删除t1表中id=1的行，并使用DELETE ... INNER JOIN语句删除t2表中的ref=1的行记录：</div><div class="line"></div><div class="line"><span class="keyword">DELETE</span> t1 , t2 <span class="keyword">FROM</span> t1</div><div class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">    t2 <span class="keyword">ON</span> t2.ref = t1.id </div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    t1.id = <span class="number">1</span>;</div></pre></td></tr></table></figure>
<h3 id="DELETE-与-LEFT-JOIN"><a href="#DELETE-与-LEFT-JOIN" class="headerlink" title="DELETE 与 LEFT JOIN"></a>DELETE 与 LEFT JOIN</h3><p>以下语法说明如何使用DELETE语句与LEFT JOIN子句来删除与T2表中没有相应匹配行的表T1中的行记录：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DELETE</span> T1 </div><div class="line"><span class="keyword">FROM</span> T1</div><div class="line">        <span class="keyword">LEFT</span> <span class="keyword">JOIN</span></div><div class="line">    T2 <span class="keyword">ON</span> T1.key = T2.key </div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    T2.key <span class="keyword">IS</span> <span class="literal">NULL</span>;</div></pre></td></tr></table></figure>
<h2 id="REPLACE"><a href="#REPLACE" class="headerlink" title="REPLACE"></a>REPLACE</h2><p>MySQL REPLACE语句是标准SQL的MySQL扩展。 MySQL REPLACE语句的工作原理如下：</p>
<ul>
<li>如果给定行数据不存在，那么MySQL REPLACE语句会插入一个新行。</li>
<li>如果给定行数据存在，则REPLACE语句首先删除旧行，然后插入一个新行。 在某些情况下，REPLACE语句仅更新现有行。</li>
<li>MySQL使用PRIMARY KEY或UNIQUE KEY索引来要确定表中是否存在新行。如果表没有这些索引，则REPLACE语句等同于INSERT语句。</li>
</ul>
<h3 id="REPLACE第一种形式"><a href="#REPLACE第一种形式" class="headerlink" title="REPLACE第一种形式"></a>REPLACE第一种形式</h3><p>REPLACE语句的第一种形式类似于INSERT语句，除了INSERT关键字换成REPLACE关键字以外，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">REPLACE</span> <span class="keyword">INTO</span> table_name(column_list)</div><div class="line"><span class="keyword">VALUES</span>(value_list);</div></pre></td></tr></table></figure>
<h3 id="REPLACE第二种形式"><a href="#REPLACE第二种形式" class="headerlink" title="REPLACE第二种形式"></a>REPLACE第二种形式</h3><p>REPLACE语句的第二种形式类似于UPDATE语句，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">REPLACE</span> <span class="keyword">INTO</span> <span class="keyword">table</span></div><div class="line"><span class="keyword">SET</span> column1 = value1,</div><div class="line">    column2 = value2;</div></pre></td></tr></table></figure>
<p>与UPDATE语句不同，如果不在SET子句中指定列的值，则REPLACE语句将使用该列的默认值。</p>
<h3 id="REPLACE第三种形式"><a href="#REPLACE第三种形式" class="headerlink" title="REPLACE第三种形式"></a>REPLACE第三种形式</h3><p>REPLACE语句的第三种形式类似于INSERT INTO SELECT语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">REPLACE</span> <span class="keyword">INTO</span> table_1(column_list)</div><div class="line"><span class="keyword">SELECT</span> column_list</div><div class="line"><span class="keyword">FROM</span> table_2</div><div class="line"><span class="keyword">WHERE</span> where_condition;</div></pre></td></tr></table></figure>
<h2 id="PREPARED"><a href="#PREPARED" class="headerlink" title="PREPARED"></a>PREPARED</h2><p>prepare语句利用客户端/服务器二进制协议。 它将包含占位符(?)的查询传递给MySQL服务器，</p>
<p>当MySQL使用不同的productcode值执行此查询时，不必完全解析查询。 因此，这有助于MySQL更快地执行查询，特别是当MySQL多次执行查询时。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">PREPARE</span> stmt1 <span class="keyword">FROM</span> <span class="string">'SELECT productCode, productName</span></div><div class="line"><span class="string">                    FROM products</span></div><div class="line"><span class="string">                    WHERE productCode = ?'</span>;</div><div class="line"></div><div class="line"><span class="keyword">SET</span> @pc = <span class="string">'S10_1678'</span>;</div><div class="line"><span class="keyword">EXECUTE</span> stmt1 <span class="keyword">USING</span> @pc;</div><div class="line"></div><div class="line"><span class="keyword">DEALLOCATE</span> <span class="keyword">PREPARE</span> stmt1;</div></pre></td></tr></table></figure>
<p>首先，使用PREPARE语句准备执行语句。我们使用SELECT语句根据指定的产品代码从products表查询产品数据。然后再使用问号(?)作为产品代码的占位符。</p>
<p>接下来，声明了一个产品代码变量@pc，并将其值设置为S10_1678。</p>
<p>然后，使用EXECUTE语句来执行产品代码变量@pc的准备语句。</p>
<p>最后，我们使用DEALLOCATE PREPARE来发布PREPARE语句。</p>
<h2 id="WHERE及子操作符IN-BETWEEN-LIKE"><a href="#WHERE及子操作符IN-BETWEEN-LIKE" class="headerlink" title="WHERE及子操作符IN BETWEEN LIKE"></a>WHERE及子操作符IN BETWEEN LIKE</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN table_name1, table_name2...</div><div class="line">[<span class="keyword">WHERE</span> condition1 [<span class="keyword">AND</span> [<span class="keyword">OR</span>]] condition2.....</div></pre></td></tr></table></figure>
<ul>
<li>WHERE可以与DELETE 或 UPDATE一起使用，也可以指定一个条件使用。</li>
<li>可以指定一个以上的条件在使用AND或OR运算符。</li>
<li>BINARY关键词使搜索区分大小写(默认是不区分的)<ul>
<li>如<code>WHERE BINARY tutorial_author=&#39;yiibai&#39;</code></li>
</ul>
</li>
</ul>
<p>下表列出了可用于在WHERE子句中形成过滤表达式的比较运算符</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>=</code></td>
<td>几乎任何数据类型都适用</td>
</tr>
<tr>
<td><code>&lt;&gt;</code>或<code>!=</code></td>
<td>不等于</td>
</tr>
<tr>
<td><code>&lt;</code></td>
<td>通常适用数字和时间数据类型</td>
</tr>
<tr>
<td><code>&gt;</code></td>
<td>同上</td>
</tr>
<tr>
<td><code>&lt;=</code></td>
<td>同上</td>
</tr>
<tr>
<td><code>&gt;=</code></td>
<td>同上</td>
</tr>
</tbody>
</table>
<h3 id="AND-OR"><a href="#AND-OR" class="headerlink" title="AND OR"></a>AND OR</h3><p>当您在语句中使用多个逻辑运算符时，MySQL会在AND运算符之后再对OR运算符进行求值。 这称为运算符优先级。要更改优先级顺序，请使用括号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> (<span class="literal">true</span> <span class="keyword">OR</span> <span class="literal">false</span>) <span class="keyword">AND</span> <span class="literal">false</span>;</div></pre></td></tr></table></figure>
<h3 id="IN"><a href="#IN" class="headerlink" title="IN"></a>IN</h3><p>IN运算符确定指定的值是否在列表中，有则返回1，没有则返回0</p>
<p>语法如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    column1,column2,...</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    table_name</div><div class="line"><span class="keyword">WHERE</span> </div><div class="line"> (expr|column_1) <span class="keyword">IN</span> (<span class="string">'value1'</span>,<span class="string">'value2'</span>,...);</div></pre></td></tr></table></figure>
<p>有说明如下</p>
<ul>
<li>IN操作符也可以用在其他语句(如INSERT，UPDATE，DELETE等)的WHERE子句中。</li>
<li>列表中的值以逗号分割</li>
</ul>
<p>例子</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    officeCode, city, phone, country</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    offices</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    country <span class="keyword">IN</span> (<span class="string">'USA'</span> , <span class="string">'France'</span>);</div></pre></td></tr></table></figure>
<p>如果列表中有很多值，使用多个OR运算符则会构造一个非常长的语句。 因此，使用IN运算符则会缩短查询并使查询更易读。</p>
<p>IN 同样可以和 NOT 连用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    officeCode, city, phone</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    offices</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    country <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="string">'USA'</span> , <span class="string">'France'</span>);</div></pre></td></tr></table></figure>
<h4 id="IN-与子查询"><a href="#IN-与子查询" class="headerlink" title="IN 与子查询"></a>IN 与子查询</h4><p>IN运算符通常用于子查询，子查询不提供常量值列表，而是提供值列表，即把所有的值展示出来，不手打输入。</p>
<p>例如，如果要查找总金额大于60000的订单，则使用IN运算符查询如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    orderNumber, customerNumber, <span class="keyword">status</span>, shippedDate</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    orderNumber <span class="keyword">IN</span> (<span class="keyword">SELECT</span> </div><div class="line">            orderNumber</div><div class="line">        <span class="keyword">FROM</span></div><div class="line">            orderDetails</div><div class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> orderNumber</div><div class="line">        <span class="keyword">HAVING</span> <span class="keyword">SUM</span>(quantityOrdered * priceEach) &gt; <span class="number">60000</span>);</div></pre></td></tr></table></figure>
<h3 id="BETWEEN-运算符"><a href="#BETWEEN-运算符" class="headerlink" title="BETWEEN 运算符"></a>BETWEEN 运算符</h3><p>BETWEEN运算符允许指定要测试的值范围。 我们经常在SELECT，INSERT，UPDATE和DELETE语句的WHERE子句中使用BETWEEN运算符。</p>
<p>下面说明了BETWEEN运算符的语法，一般而言，BETWEEN也可以被过滤运算符和AND OR重写：</p>
<p><code>expr [NOT] BETWEEN begin_expr AND end_expr;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT </div><div class="line">    productCode, productName, buyPrice</div><div class="line">FROM</div><div class="line">    products</div><div class="line">WHERE</div><div class="line">    buyPrice NOT BETWEEN 20 AND 100;</div><div class="line">+<span class="comment">-------------+-------------------------------------+----------+</span></div><div class="line">| productCode | productName                         | buyPrice |</div><div class="line">+<span class="comment">-------------+-------------------------------------+----------+</span></div><div class="line">| S10_4962    | 1962 LanciaA Delta 16V              | 103.42   |</div><div class="line">| S18_2238    | 1998 Chrysler Plymouth Prowler      | 101.51   |</div><div class="line">| S24_2840    | 1958 Chevy Corvette Limited Edition | 15.91    |</div><div class="line">| S24_2972    | 1982 Lamborghini Diablo             | 16.24    |</div><div class="line">+<span class="comment">-------------+-------------------------------------+----------+</span></div><div class="line">4 rows in <span class="keyword">set</span></div><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    productCode, productName, buyPrice</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    products</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    buyPrice &lt; <span class="number">20</span> <span class="keyword">OR</span> buyPrice &gt; <span class="number">100</span>;</div></pre></td></tr></table></figure>
<h4 id="BETWEEN-和-日期类型数据"><a href="#BETWEEN-和-日期类型数据" class="headerlink" title="BETWEEN 和 日期类型数据"></a>BETWEEN 和 日期类型数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> orderNumber,</div><div class="line">         requiredDate,</div><div class="line">         <span class="keyword">status</span></div><div class="line"><span class="keyword">FROM</span> orders</div><div class="line"><span class="keyword">WHERE</span> requireddate</div><div class="line">    <span class="keyword">BETWEEN</span> <span class="keyword">CAST</span>(<span class="string">'2013-01-01'</span> <span class="keyword">AS</span> <span class="built_in">DATE</span>)</div><div class="line">        <span class="keyword">AND</span> <span class="keyword">CAST</span>(<span class="string">'2013-01-31'</span> <span class="keyword">AS</span> <span class="built_in">DATE</span>);</div></pre></td></tr></table></figure>
<p>因为requiredDate列的数据类型是DATE，所以我们使用转换运算符将文字字符串“2013-01-01”和“2013-12-31”转换为DATE数据类型。</p>
<h3 id="LIKE"><a href="#LIKE" class="headerlink" title="LIKE"></a>LIKE</h3><p>LIKE操作符通常用于基于模式查询选择数据。MySQL提供两个通配符，用于与LIKE运算符一起使用，它们分别是：百分比符号 - %和下划线 - _。</p>
<ul>
<li>百分比(%)通配符允许匹配任何字符串的零个或多个字符。</li>
<li>下划线(_)通配符允许匹配任何单个字符。</li>
<li>LIKE支持 NOT 组合</li>
<li>大小写不敏感</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN table_name1, table_name2...</div><div class="line"><span class="keyword">WHERE</span> field1 <span class="keyword">LIKE</span> condition1 [<span class="keyword">AND</span> [<span class="keyword">OR</span>]] filed2 = <span class="string">'somevalue'</span></div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">from</span> tutorials_tbl <span class="keyword">WHERE</span> tutorial_author <span class="keyword">LIKE</span> <span class="string">'%aul'</span>;</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">| tutorial_id | tutorial_title | tutorial_author | submission_date |</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">|           3 | JAVA Tutorial  | Paul            | 2015-07-17      |</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">1 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</div></pre></td></tr></table></figure>
<ul>
<li>可以使用LIKE子句在WHERE子句中</li>
<li>可以使用LIKE子句代替等号(=)</li>
<li>当LIKE连同%符号使用，那么它就会像一个元字符的搜索</li>
<li>可以指定一个以上的条件使用AND或OR运算符</li>
<li>WHERE… LIKE子句可以使用SQL命令的DELETE 或 UPDATE ，也可以指定一个条件</li>
</ul>
<h4 id="LIKE-与-ESCAPE-子句"><a href="#LIKE-与-ESCAPE-子句" class="headerlink" title="LIKE 与 ESCAPE 子句"></a>LIKE 与 ESCAPE 子句</h4><p>如果需要匹配的文本包含 通配符，则可以</p>
<ul>
<li>使用ESCAPE 子句指定转义字符</li>
<li>使用默认转义字符：反斜杠\</li>
</ul>
<p>下方两种方法效果一样。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    productCode, productName</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    products</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    productCode <span class="keyword">LIKE</span> <span class="string">'%$_20%'</span> ESCAPE <span class="string">'$'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    productCode, productName</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    products</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    productCode <span class="keyword">LIKE</span> <span class="string">'%\_20%'</span>;</div></pre></td></tr></table></figure>
<p>LIKE操作符强制MySQL扫描整个表以找到匹配的行记录，因此，它不允许数据库引擎使用索引进行快速搜索。因此，当要从具有大量行的表查询数据时，使用LIKE运算符来查询数据的性能会大幅降低。</p>
<h3 id="LIMIT"><a href="#LIMIT" class="headerlink" title="LIMIT"></a>LIMIT</h3><p>LIMIT子句用来约束结果集中的行数。LIMIT子句接受一个或两个参数。两个参数的值必须为零或正整数。</p>
<p>语法如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    column1,column2,...</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    <span class="keyword">table</span></div><div class="line"><span class="keyword">LIMIT</span> <span class="keyword">offset</span> , <span class="keyword">count</span>;</div><div class="line"></div><div class="line"><span class="comment">---------</span></div><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    column1,column2,...</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    <span class="keyword">table</span></div><div class="line"><span class="keyword">LIMIT</span> <span class="keyword">count</span>;</div></pre></td></tr></table></figure>
<ul>
<li>offset参数指定要返回的第一行的偏移量。第一行的偏移量为0，而不是1。</li>
<li>count指定要返回的最大行数。</li>
</ul>
<h4 id="LIMIT-与-ORDER-BY-混用"><a href="#LIMIT-与-ORDER-BY-混用" class="headerlink" title="LIMIT 与 ORDER BY 混用"></a>LIMIT 与 ORDER BY 混用</h4><p>要查询信用额度最高的前五名客户，请使用以下查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> customernumber, customername, creditlimit</div><div class="line"><span class="keyword">FROM</span> customers</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> creditlimit <span class="keyword">DESC</span></div><div class="line"><span class="keyword">LIMIT</span> <span class="number">5</span>;</div></pre></td></tr></table></figure>
<p>获得结果集中的第n个最高值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    column1, column2,...</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    <span class="keyword">table</span></div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> column1 <span class="keyword">DESC</span></div><div class="line"><span class="keyword">LIMIT</span> nth<span class="number">-1</span>, <span class="keyword">count</span>;</div></pre></td></tr></table></figure>
<h2 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a>ORDER BY</h2><p>ORDER BY子句允许：</p>
<ul>
<li>对单个列或多个列排序结果集。</li>
<li>按升序或降序对不同列的结果集进行排序。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> column1, column2,...</div><div class="line"><span class="keyword">FROM</span> tbl</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> column1 [<span class="keyword">ASC</span>|<span class="keyword">DESC</span>], column2 [<span class="keyword">ASC</span>|<span class="keyword">DESC</span>],...</div></pre></td></tr></table></figure>
<p>ASC表示升序，DESC表示降序。默认情况下，如果不明确指定ASC或DESC，ORDER BY子句会按照升序对结果集进行排序。</p>
<h4 id="ORDER-BY-允许对结果集根据表达式进行排序"><a href="#ORDER-BY-允许对结果集根据表达式进行排序" class="headerlink" title="ORDER BY 允许对结果集根据表达式进行排序"></a>ORDER BY 允许对结果集根据表达式进行排序</h4><p>如我们计算表orderdetails中quantityOrdered * priceEach的数值并根据它进行排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span></div><div class="line"> ordernumber,</div><div class="line"> orderlinenumber,</div><div class="line"> quantityOrdered * priceEach <span class="keyword">AS</span> subtotal</div><div class="line"><span class="keyword">FROM</span></div><div class="line"> orderdetails</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></div><div class="line"> ordernumber,</div><div class="line"> orderLineNumber,</div><div class="line"> subtotal;</div></pre></td></tr></table></figure>
<h4 id="ORDER-BY-与自定义排序"><a href="#ORDER-BY-与自定义排序" class="headerlink" title="ORDER BY 与自定义排序"></a>ORDER BY 与自定义排序</h4><p>ORDER BY子句允许使用FIELD()函数为列中的值定义自己的自定义排序顺序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT </div><div class="line">    orderNumber, status</div><div class="line">FROM</div><div class="line">    orders</div><div class="line">ORDER BY FIELD(status,</div><div class="line">        'In Process',</div><div class="line">        'On Hold',</div><div class="line">        'Cancelled',</div><div class="line">        'Resolved',</div><div class="line">        'Disputed',</div><div class="line">        'Shipped');</div><div class="line">+<span class="comment">-------------+------------+</span></div><div class="line">| orderNumber | status     |</div><div class="line">+<span class="comment">-------------+------------+</span></div><div class="line">|       10420 | In Process |</div><div class="line">|       10421 | In Process |</div><div class="line">... ...</div><div class="line">|       10413 | Shipped    |</div><div class="line">|       10416 | Shipped    |</div><div class="line">|       10418 | Shipped    |</div><div class="line">|       10419 | Shipped    |</div><div class="line">+<span class="comment">-------------+------------+</span></div><div class="line">326 rows in <span class="keyword">set</span></div></pre></td></tr></table></figure>
<h4 id="ORDER-BY-与自然排序"><a href="#ORDER-BY-与自然排序" class="headerlink" title="ORDER BY 与自然排序"></a>ORDER BY 与自然排序</h4><p>考虑如下一个表items</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> items (</div><div class="line">    <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span>,</div><div class="line">    item_no <span class="built_in">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> items(item_no)</div><div class="line"><span class="keyword">VALUES</span> (<span class="string">'1'</span>),</div><div class="line">       (<span class="string">'1C'</span>),</div><div class="line">       (<span class="string">'10Z'</span>),</div><div class="line">       (<span class="string">'2A'</span>),</div><div class="line">       (<span class="string">'2'</span>),</div><div class="line">       (<span class="string">'3C'</span>),</div><div class="line">       (<span class="string">'20D'</span>);</div><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    item_no</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    items</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> item_no;</div><div class="line"></div><div class="line">+<span class="comment">---------+</span></div><div class="line">| item_no |</div><div class="line">+<span class="comment">---------+</span></div><div class="line">| 1       |</div><div class="line">| 10Z     |</div><div class="line">| 1C      |</div><div class="line">| 2       |</div><div class="line">| 20D     |</div><div class="line">| 2A      |</div><div class="line">| 3C      |</div><div class="line">+<span class="comment">---------+</span></div><div class="line">7 rows in <span class="keyword">set</span></div></pre></td></tr></table></figure>
<p>但是我们需要的排序是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">+---------+</div><div class="line">| item_no |</div><div class="line">+---------+</div><div class="line">| 1       |</div><div class="line">| 1C      |</div><div class="line">| 2       |</div><div class="line">| 2A      |</div><div class="line">| 3C      |</div><div class="line">| 10Z     |</div><div class="line">| 20D     |</div><div class="line">+---------+</div></pre></td></tr></table></figure>
<p>为了达到这个效果，我们考虑将item_no分成两列，prefix和suffix，再对两列进行排序以解决问题</p>
<p>当然如果数据格式相当标准，我们可以使用以下方法进行排序，而无需增加列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    item_no</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    items</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">CAST</span>(item_no <span class="keyword">AS</span> <span class="keyword">UNSIGNED</span>) , item_no;</div></pre></td></tr></table></figure>
<p>首先使用类型转换将item_no数据转换为无符号整数。 其次，使用ORDER BY子句对数字进行数字排序，然后按字母顺序排列。</p>
<p>还有一个常见的问题如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> items;</div><div class="line"></div><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> items(item_no)</div><div class="line"><span class="keyword">VALUES</span>(<span class="string">'A-1'</span>),</div><div class="line">      (<span class="string">'A-2'</span>),</div><div class="line">      (<span class="string">'A-3'</span>),</div><div class="line">      (<span class="string">'A-4'</span>),</div><div class="line">      (<span class="string">'A-5'</span>),</div><div class="line">      (<span class="string">'A-10'</span>),</div><div class="line">      (<span class="string">'A-11'</span>),</div><div class="line">      (<span class="string">'A-20'</span>),</div><div class="line">      (<span class="string">'A-30'</span>);</div><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    item_no</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    items</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">LENGTH</span>(item_no) , item_no;</div></pre></td></tr></table></figure>
<p>该方法首先对字符串长度进行排序，以保证个位数的数字在前，然后再对其进行排序</p>
<h2 id="UPDATE语法"><a href="#UPDATE语法" class="headerlink" title="UPDATE语法"></a>UPDATE语法</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> table_name <span class="keyword">SET</span> field1=<span class="keyword">new</span>-value1, field2=<span class="keyword">new</span>-value2</div><div class="line">[<span class="keyword">WHERE</span> Clause]</div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">UPDATE</span> tutorials_tbl </div><div class="line">    -&gt; <span class="keyword">SET</span> tutorial_title=<span class="string">'Learning JAVA'</span> </div><div class="line">    -&gt; <span class="keyword">WHERE</span> tutorial_id=<span class="number">3</span>;</div><div class="line">Query OK, 1 row affected (0.04 sec)</div><div class="line">Rows matched: 1  Changed: 1  Warnings: 0</div></pre></td></tr></table></figure>
<h2 id="DELETE语法"><a href="#DELETE语法" class="headerlink" title="DELETE语法"></a>DELETE语法</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> Clause]</div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">DELETE</span> <span class="keyword">FROM</span> tutorials_tbl <span class="keyword">WHERE</span> tutorial_id=<span class="number">3</span>;</div><div class="line">Query OK, 1 row affected (0.23 sec)</div></pre></td></tr></table></figure>
<ul>
<li>如果WHERE子句没有指定，则所有MySQL表中的记录将均被删除。</li>
<li>删除的记录是具体哪些依据WHERE子句确定</li>
</ul>
<h2 id="ORDER-BY将查询结果排序"><a href="#ORDER-BY将查询结果排序" class="headerlink" title="ORDER BY将查询结果排序"></a>ORDER BY将查询结果排序</h2><p>当选择数据行，MySQL服务器可以自由地返回它们的顺序，除非有指示它按照怎样的结果进行排序。但是排序结果可以通过增加一个ORDER BY子句设定列名称或要排序的列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN table_name1, table_name2...</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> field1, [field2...] [<span class="keyword">ASC</span> [<span class="keyword">DESC</span>]]</div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">from</span> tutorials_tbl <span class="keyword">ORDER</span> <span class="keyword">BY</span> tutorial_author <span class="keyword">ASC</span>;</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">| tutorial_id | tutorial_title | tutorial_author | submission_date |</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">|           1 | Learn PHP      | Paul            | 2015-07-17      |</div><div class="line">|           2 | Learn MySQL    | Saya            | 2015-07-17      |</div><div class="line">|           3 | Learning JAVA  | Yiibai          | 2007-05-06      |</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">3 rows in <span class="keyword">set</span></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<ul>
<li>可以使用WHERE … LIKE子句以通用的方式放置条件</li>
<li>使用关键字 ASC 或 DESC 来执行升序或降序排列。</li>
</ul>
<h2 id="Join联接"><a href="#Join联接" class="headerlink" title="Join联接"></a>Join联接</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT * FROM tcount_tbl;</div><div class="line">+<span class="comment">-----------------+----------------+</span></div><div class="line">| tutorial_author | tutorial_count |</div><div class="line">+<span class="comment">-----------------+----------------+</span></div><div class="line">| mahran          |             10 |</div><div class="line">| mahnaz          |              0 |</div><div class="line">| Jen             |              0 |</div><div class="line">| Gill            |             20 |</div><div class="line">| Paul            |             10 |</div><div class="line">| yiibai          |             10 |</div><div class="line">+<span class="comment">-----------------+----------------+</span></div><div class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</div><div class="line">mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">from</span> tutorials_tbl;</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">| tutorial_id | tutorial_title | tutorial_author | submission_date |</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">|           1 | Learn PHP      | Paul            | 2015-07-17      |</div><div class="line">|           2 | Learn MySQL    | Saya            | 2015-07-17      |</div><div class="line">|           3 | Learning JAVA  | yiibai          | 2007-05-06      |</div><div class="line">+<span class="comment">-------------+----------------+-----------------+-----------------+</span></div><div class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div><div class="line"></div><div class="line">#现在我们可以写一个<span class="keyword">SQL</span>查询来连接这两个表。此查询将从表tutorials_tbl和tcount_tbl 选择所有作者的教程数量。</div><div class="line">mysql&gt; <span class="keyword">SELECT</span> a.tutorial_id, a.tutorial_author, b.tutorial_count</div><div class="line">    -&gt; <span class="keyword">FROM</span> tutorials_tbl a, tcount_tbl b</div><div class="line">    -&gt; <span class="keyword">WHERE</span> a.tutorial_author = b.tutorial_author;</div><div class="line">+<span class="comment">-------------+-----------------+----------------+</span></div><div class="line">| tutorial_id | tutorial_author | tutorial_count |</div><div class="line">+<span class="comment">-------------+-----------------+----------------+</span></div><div class="line">|           1 | Paul            |             10 |</div><div class="line">|           3 | Yiibai          |             10 |</div><div class="line">+<span class="comment">-------------+-----------------+----------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</div></pre></td></tr></table></figure>
<h3 id="如何处理NULL值查询？"><a href="#如何处理NULL值查询？" class="headerlink" title="如何处理NULL值查询？"></a>如何处理NULL值查询？</h3><p> 涉及NULL的条件是特殊的。不能使用= NULL或！= NULL来匹配查找列的NULL值。这样的比较总是失败，因为它是不可能告诉它们是否是true。 甚至 NULL = NULL 也是失败的。</p>
<p>要查找列的值是或不是NULL，使用IS NULL或IS NOT NULL。</p>
<p>MySQL提供了三大运算符</p>
<ul>
<li>IS NULL: 如果列的值为NULL，运算结果返回 true</li>
<li>IS NOT NULL: 如果列的值不为NULL，运算结果返回 true</li>
<li>&lt;=&gt;: 运算符比较值，(不同于=运算符)即使两个空值它返回 true</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT * from tcount_tbl </div><div class="line">    -&gt; WHERE tutorial_count IS NOT NULL;</div><div class="line">+<span class="comment">-----------------+----------------+</span></div><div class="line">| tutorial_author | tutorial_count |</div><div class="line">+<span class="comment">-----------------+----------------+</span></div><div class="line">| mahran          |             20 |</div><div class="line">| Gill            |             20 |</div><div class="line">+<span class="comment">-----------------+----------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure>
<h2 id="MySQL正则表达式"><a href="#MySQL正则表达式" class="headerlink" title="MySQL正则表达式"></a>MySQL正则表达式</h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">通用语法</div><div class="line">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP 'ok$';</div></pre></td></tr></table></figure>
<h2 id="MySQL连接表"><a href="#MySQL连接表" class="headerlink" title="MySQL连接表"></a>MySQL连接表</h2><h3 id="列别名"><a href="#列别名" class="headerlink" title="列别名"></a>列别名</h3><p>有时，列的名称是一些表达式，使查询的输出很难理解。要给列一个描述性名称，可以使用列别名。</p>
<p>语法如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line"> [column_1 | expression] <span class="keyword">AS</span> <span class="string">`descriptive name`</span></div><div class="line"><span class="keyword">FROM</span> table_name;</div><div class="line"></div><div class="line"># 例子</div><div class="line"></div><div class="line">mysql&gt; SELECT </div><div class="line">    CONCAT_WS(', ', lastName, firstname)</div><div class="line">FROM</div><div class="line">    employees;</div><div class="line">+<span class="comment">--------------------------------------+</span></div><div class="line">| CONCAT_WS(', ', lastName, firstname) |</div><div class="line">+<span class="comment">--------------------------------------+</span></div><div class="line">| Murphy, Diane                        |</div><div class="line">....</div><div class="line">+<span class="comment">--------------------------------------+</span></div><div class="line">23 rows in <span class="keyword">set</span></div><div class="line"></div><div class="line"># 上方的变量名非常难以阅读，此时可以引入列别名</div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">SELECT</span></div><div class="line"> <span class="keyword">CONCAT_WS</span>(<span class="string">', '</span>, lastName, firstname) <span class="keyword">AS</span> <span class="string">`Full name`</span></div><div class="line"><span class="keyword">FROM</span></div><div class="line"> employees;</div></pre></td></tr></table></figure>
<p>``是为了避免名称中含有空格</p>
<p>MySQL中，可以使用ORDER BY，GROUP BY和HAVING子句中的列别名来引用该列。</p>
<p>以下查询使用ORDER BY子句中的列别名按字母顺序排列员工的全名：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span></div><div class="line"> <span class="keyword">CONCAT_WS</span>(<span class="string">' '</span>, lastName, firstname) <span class="string">`Full name`</span></div><div class="line"><span class="keyword">FROM</span></div><div class="line"> employees</div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></div><div class="line"> <span class="string">`Full name`</span>;</div></pre></td></tr></table></figure>
<p>以下语句查询总金额大于60000的订单。它在GROUP BY和HAVING子句中使用列别名。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span></div><div class="line"> orderNumber <span class="string">`Order no.`</span>,</div><div class="line"> <span class="keyword">SUM</span>(priceEach * quantityOrdered) total</div><div class="line"><span class="keyword">FROM</span></div><div class="line"> orderdetails</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></div><div class="line"> <span class="string">`Order no.`</span></div><div class="line"><span class="keyword">HAVING</span></div><div class="line"> total &gt; <span class="number">60000</span>;</div></pre></td></tr></table></figure>
<blockquote>
<p>请注意，不能在WHERE子句中使用列别名。原因是当MySQL评估求值WHERE子句时，SELECT子句中指定的列的值可能尚未确定。</p>
</blockquote>
<h3 id="表别名"><a href="#表别名" class="headerlink" title="表别名"></a>表别名</h3><p>一般在包含INNER JOIN，LEFT JOIN，self join子句和子查询的语句中使用表别名。</p>
<p>因为有的时候，我们使用INNER JOIN连接表时，两个表的列名是一样的，则此时应该使用别名以示区分，书写方便。</p>
<p><code>table_name AS table_alias</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span></div><div class="line"> customerName,</div><div class="line"> <span class="keyword">COUNT</span>(o.orderNumber) total</div><div class="line"><span class="keyword">FROM</span></div><div class="line"> customers c</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> orders o <span class="keyword">ON</span> c.customerNumber = o.customerNumber</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></div><div class="line"> customerName</div><div class="line"><span class="keyword">HAVING</span> total &gt;=<span class="number">5</span></div><div class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></div><div class="line"> total <span class="keyword">DESC</span>;</div></pre></td></tr></table></figure>
<h3 id="内连接-INNER-JOIN"><a href="#内连接-INNER-JOIN" class="headerlink" title="内连接 INNER JOIN"></a>内连接 INNER JOIN</h3><p>内连接用于连接主表与副表，产生新的行记录，对于t1表中的每一行，INNER JOIN子句将它与t2表的每一行进行比较，以检查它们是否都满足连接条件。当满足连接条件时，INNER JOIN将返回由t1和t2表中的列组成的新行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> column_list</div><div class="line"><span class="keyword">FROM</span> t1</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> t2 <span class="keyword">ON</span> join_condition1</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> t3 <span class="keyword">ON</span> join_condition2</div><div class="line">...</div><div class="line"><span class="keyword">WHERE</span> where_conditions;</div><div class="line"></div><div class="line"></div><div class="line">简化语法如下</div><div class="line"><span class="keyword">SELECT</span> column_list</div><div class="line"><span class="keyword">FROM</span> t1</div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> t2 <span class="keyword">ON</span> join_condition;</div></pre></td></tr></table></figure>
<p>通过使用INNER JOIN子句根据productline列匹配行来从两个表中查询选择数据，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    productCode, </div><div class="line">    productName, </div><div class="line">    textDescription</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    products t1</div><div class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">    productlines t2 <span class="keyword">ON</span> t1.productline = t2.productline;</div></pre></td></tr></table></figure>
<p>由于两个表的连接列是使用相同一个列：productline，因此可以使用以下语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    productCode, </div><div class="line">    productName, </div><div class="line">    textDescription</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    products</div><div class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">    productlines <span class="keyword">USING</span> (productline);</div></pre></td></tr></table></figure>
<p>可以使用具有GROUP BY子句的INNER JOIN子句从orders和orderdetails表中获取订单号，订单状态和总销售额，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    T1.orderNumber,</div><div class="line">    <span class="keyword">status</span>,</div><div class="line">    <span class="keyword">SUM</span>(quantityOrdered * priceEach) total</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders <span class="keyword">AS</span> T1</div><div class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">    orderdetails <span class="keyword">AS</span> T2 <span class="keyword">ON</span> T1.orderNumber = T2.orderNumber</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> orderNumber;</div></pre></td></tr></table></figure>
<h3 id="左连接"><a href="#左连接" class="headerlink" title="左连接"></a>左连接</h3><p>左连接允许从多个表中联立查询数据，且语法类似于内连接，如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    t1.c1, t1.c2, t2.c1, t2.c2</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    t1</div><div class="line">        <span class="keyword">LEFT</span> <span class="keyword">JOIN</span></div><div class="line">    t2 <span class="keyword">ON</span> t1.c1 = t2.c1;</div></pre></td></tr></table></figure>
<p>其与内连接的区别是，左连接会包括主表的所有记录，如果在右表中未查询到信息，则以空信息代替。故名称是左连接</p>
<p>要查询每个客户的所有订单，可以使用LEFT JOIN子句，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span></div><div class="line"> c.customerNumber,</div><div class="line"> c.customerName,</div><div class="line"> orderNumber,</div><div class="line"> o.status</div><div class="line"><span class="keyword">FROM</span></div><div class="line"> customers c</div><div class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> orders o <span class="keyword">ON</span> c.customerNumber = o.customerNumber;</div></pre></td></tr></table></figure>
<p>疑问：为什么在LEFT JOIN中的ON条件与WHERE子句不能同等替代，而对于INNER JOIN子句，ON子句中的条件等同于WHERE子句中的条件。</p>
<h3 id="CROSS-JOIN"><a href="#CROSS-JOIN" class="headerlink" title="CROSS JOIN"></a>CROSS JOIN</h3><h2 id="分组数据"><a href="#分组数据" class="headerlink" title="分组数据"></a>分组数据</h2><h3 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a>GROUP BY</h3><p>GROUP BY子句通过列或表达式的值将一组行分组为一个小分组的汇总行记录。 GROUP BY子句为每个分组返回一行。换句话说，它减少了结果集中的行数。</p>
<p>经常使用GROUP BY子句与聚合函数一起使用，如SUM，AVG，MAX，MIN和COUNT。SELECT子句中使用聚合函数来计算有关每个分组的信息。</p>
<p>假设要将订单状态的值分组到子组中，则要使用GROUP BY子句并指定按status 列来执行分组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">status</span></div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">status</span>;</div><div class="line"></div><div class="line">+<span class="comment">------------+</span></div><div class="line">| status     |</div><div class="line">+<span class="comment">------------+</span></div><div class="line">| Cancelled  |</div><div class="line">| Disputed   |</div><div class="line">| In Process |</div><div class="line">| On Hold    |</div><div class="line">| Resolved   |</div><div class="line">| Shipped    |</div><div class="line">+<span class="comment">------------+</span></div></pre></td></tr></table></figure>
<p>可以看到，GROUP BY子句返回状态(status)值是唯一的。它像DISTINCT运算符一样工作</p>
<h3 id="GROUP-BY-与聚合函数"><a href="#GROUP-BY-与聚合函数" class="headerlink" title="GROUP BY 与聚合函数"></a>GROUP BY 与聚合函数</h3><p>可使用聚合函数来执行一组行的计算并返回单个值。 GROUP BY子句通常与聚合函数一起使用以执行计算每个分组并返回单个值。</p>
<p>例如，如果想知道每个状态中的订单数，可以使用COUNT函数与GROUP BY子句查询语句，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">status</span>, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> total_number</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">status</span>;</div><div class="line"></div><div class="line">+<span class="comment">------------+--------------+</span></div><div class="line">| status     | total_number |</div><div class="line">+<span class="comment">------------+--------------+</span></div><div class="line">| Cancelled  |            6 |</div><div class="line">| Disputed   |            3 |</div><div class="line">| In Process |            6 |</div><div class="line">| On Hold    |            4 |</div><div class="line">| Resolved   |            4 |</div><div class="line">| Shipped    |          303 |</div><div class="line">+<span class="comment">------------+--------------+</span></div><div class="line">6 rows in <span class="keyword">set</span></div></pre></td></tr></table></figure>
<p>也就是说，GROUP BY起到了分组处理的作用。分组计算得出聚合函数产生的结果。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">desc orderdetails;</div><div class="line">desc orders;</div><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">status</span>, <span class="keyword">SUM</span>(quantityOrdered * priceEach) <span class="keyword">AS</span> amount</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">    orderdetails <span class="keyword">USING</span> (orderNumber)</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">status</span>;</div></pre></td></tr></table></figure>
<p>再次提醒，INNER JOIN是从右表orderdetails中查询符合连接条件的观测值，再与左表每一条观测值合并。</p>
<h3 id="GROUP-BY-用表达式示例"><a href="#GROUP-BY-用表达式示例" class="headerlink" title="GROUP BY 用表达式示例"></a>GROUP BY 用表达式示例</h3><p>除了列之外，可以按表达式对行进行分组。以下查询获取每年的总销售额</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">YEAR</span>(orderDate) <span class="keyword">AS</span> <span class="keyword">year</span>,</div><div class="line">    <span class="keyword">SUM</span>(quantityOrdered * priceEach) <span class="keyword">AS</span> total</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">    orderdetails <span class="keyword">USING</span> (orderNumber)</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    <span class="keyword">status</span> = <span class="string">'Shipped'</span></div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">YEAR</span>(orderDate);</div><div class="line"></div><div class="line">+<span class="comment">------+------------+</span></div><div class="line">| year | total      |</div><div class="line">+<span class="comment">------+------------+</span></div><div class="line">| 2013 | 3223095.80 |</div><div class="line">| 2014 | 4300602.99 |</div><div class="line">| 2015 | 1341395.85 |</div><div class="line">+<span class="comment">------+------------+</span></div></pre></td></tr></table></figure>
<h3 id="GROUP-BY-与-HAVING"><a href="#GROUP-BY-与-HAVING" class="headerlink" title="GROUP BY 与 HAVING"></a>GROUP BY 与 HAVING</h3><p>可使用HAVING 子句过滤GROUP BY 子句返回的分组，如在上述基础上选择2013年以后的年销售总额</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">YEAR</span>(orderDate) <span class="keyword">AS</span> <span class="keyword">year</span>,</div><div class="line">    <span class="keyword">SUM</span>(quantityOrdered * priceEach) <span class="keyword">AS</span> total</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">    orderdetails <span class="keyword">USING</span> (orderNumber)</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    <span class="keyword">status</span> = <span class="string">'Shipped'</span></div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span></div><div class="line"><span class="keyword">HAVING</span> <span class="keyword">year</span> &gt; <span class="number">2013</span>;</div></pre></td></tr></table></figure>
<h3 id="GROUP-BY-与标准SQL"><a href="#GROUP-BY-与标准SQL" class="headerlink" title="GROUP BY 与标准SQL"></a>GROUP BY 与标准SQL</h3><p>标准SQL不允许使用GROUP BY子句中的别名，但MySQL支持此选项。以下查询从订单日期提取年份，并对每年的订单进行计数。该year用作表达式YEAR(orderDate)的别名，它也用作GROUP BY子句中的别名，此查询在标准SQL中无效。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">YEAR</span>(orderDate) <span class="keyword">AS</span> <span class="keyword">year</span>, <span class="keyword">COUNT</span>(orderNumber)</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>;</div></pre></td></tr></table></figure>
<p>MySQL还允许您以升序或降序(标准SQL不能提供)对组进行排序。默认顺序是升序。例如，如果要按状态获取订单数量并按降序对状态进行排序，则可以使用带有DESC的GROUP BY子句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">status</span>, <span class="keyword">COUNT</span>(*)</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orders</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">status</span> <span class="keyword">DESC</span>;</div></pre></td></tr></table></figure>
<h3 id="HAVING"><a href="#HAVING" class="headerlink" title="HAVING"></a>HAVING</h3><p>在SELECT语句中使用HAVING子句来指定一组行或聚合的过滤条件。</p>
<p>HAVING子句通常与GROUP BY子句一起使用，以根据指定的条件过滤分组。如果省略GROUP BY子句，则HAVING子句的行为与WHERE子句类似。</p>
<pre><code>请注意，HAVING子句将过滤条件应用于每组分行，而WHERE子句将过滤条件应用于每个单独的行。
</code></pre><p>HAVING 对组为单位进行过滤</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    ordernumber,</div><div class="line">    <span class="keyword">SUM</span>(quantityOrdered) <span class="keyword">AS</span> itemsCount,</div><div class="line">    <span class="keyword">SUM</span>(priceeach*quantityOrdered) <span class="keyword">AS</span> total</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    orderdetails</div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> ordernumber</div><div class="line"><span class="keyword">HAVING</span> total &gt; <span class="number">50000</span> <span class="keyword">AND</span> itemsCount &gt; <span class="number">600</span>;</div></pre></td></tr></table></figure>
<h2 id="MySQL子查询，派生表和通用表达式"><a href="#MySQL子查询，派生表和通用表达式" class="headerlink" title="MySQL子查询，派生表和通用表达式"></a>MySQL子查询，派生表和通用表达式</h2><h3 id="MySQL子查询"><a href="#MySQL子查询" class="headerlink" title="MySQL子查询"></a>MySQL子查询</h3><p>MySQL子查询是嵌套在另一个查询(如SELECT，INSERT，UPDATE或DELETE)中的查询。 另外，MySQL子查询可以嵌套在另一个子查询中。</p>
<p>MySQL子查询称为内部查询，而包含子查询的查询称为外部查询。 子查询可以在使用表达式的任何地方使用，并且必须在括号中关闭。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    lastName, firstName</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    employees</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    officeCode <span class="keyword">IN</span> (<span class="keyword">SELECT</span> </div><div class="line">            officeCode</div><div class="line">        <span class="keyword">FROM</span></div><div class="line">            offices</div><div class="line">        <span class="keyword">WHERE</span></div><div class="line">            country = <span class="string">'USA'</span>);</div></pre></td></tr></table></figure>
<p>下方命令返回所有大于平均值的观测</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    customerNumber, checkNumber, amount</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    payments</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    amount &gt; (<span class="keyword">SELECT</span> </div><div class="line">            <span class="keyword">AVG</span>(amount)</div><div class="line">        <span class="keyword">FROM</span></div><div class="line">            payments);</div></pre></td></tr></table></figure>
<h3 id="FROM子句中的子查询"><a href="#FROM子句中的子查询" class="headerlink" title="FROM子句中的子查询"></a>FROM子句中的子查询</h3><p>在FROM子句中使用子查询时，从子查询返回的结果集将用作临时表。 该表称为派生表或物化子查询。</p>
<p>以下子查询将查找订单表中的最大，最小和平均数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    <span class="keyword">MAX</span>(items), <span class="keyword">MIN</span>(items), <span class="keyword">FLOOR</span>(<span class="keyword">AVG</span>(items))</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    (<span class="keyword">SELECT</span> </div><div class="line">        orderNumber, <span class="keyword">COUNT</span>(orderNumber) <span class="keyword">AS</span> items</div><div class="line">    <span class="keyword">FROM</span></div><div class="line">        orderdetails</div><div class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> orderNumber) <span class="keyword">AS</span> lineitems;</div><div class="line"></div><div class="line">+<span class="comment">------------+------------+-------------------+</span></div><div class="line">| MAX(items) | MIN(items) | FLOOR(AVG(items)) |</div><div class="line">+<span class="comment">------------+------------+-------------------+</span></div><div class="line">|         18 |          1 | 9                 |</div><div class="line">+<span class="comment">------------+------------+-------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure>
<h3 id="MySQL相关子查询"><a href="#MySQL相关子查询" class="headerlink" title="MySQL相关子查询"></a>MySQL相关子查询</h3><p>与独立子查询不同，相关子查询是使用外部查询中的数据的子查询。 换句话说，相关的子查询取决于外部查询。 对外部查询中的每一行对相关子查询进行一次评估。<br>即对于独立子查询，其子查询部分可以独立出来，不受外部查询影响，而相关子查询则因为引入了外部条件而受外部影响。</p>
<p>在以下查询中，我们查询选择购买价格高于每个产品线中的产品的平均购买价格的产品。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    productname,</div><div class="line">    buyprice</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    products p1</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    buyprice &gt; (<span class="keyword">SELECT</span> </div><div class="line">            <span class="keyword">AVG</span>(buyprice)</div><div class="line">        <span class="keyword">FROM</span></div><div class="line">            products</div><div class="line">        <span class="keyword">WHERE</span></div><div class="line">            productline = p1.productline);</div></pre></td></tr></table></figure>
<h3 id="MySQL子查询与EXISTS和NOT-EXISTS"><a href="#MySQL子查询与EXISTS和NOT-EXISTS" class="headerlink" title="MySQL子查询与EXISTS和NOT EXISTS"></a>MySQL子查询与EXISTS和NOT EXISTS</h3><p>当子查询与EXISTS或NOT EXISTS运算符一起使用时，子查询返回一个布尔值为TRUE或FALSE的值。</p>
<p>可以使用上面的查询作为相关子查询，通过使用EXISTS运算符来查找至少有一个总额大于60000的销售订单的客户信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    customerNumber, </div><div class="line">    customerName</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    customers</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    <span class="keyword">EXISTS</span>( <span class="keyword">SELECT</span> </div><div class="line">            orderNumber, <span class="keyword">SUM</span>(priceEach * quantityOrdered)</div><div class="line">        <span class="keyword">FROM</span></div><div class="line">            orderdetails</div><div class="line">                <span class="keyword">INNER</span> <span class="keyword">JOIN</span></div><div class="line">            orders <span class="keyword">USING</span> (orderNumber)</div><div class="line">        <span class="keyword">WHERE</span></div><div class="line">            customerNumber = customers.customerNumber</div><div class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> orderNumber</div><div class="line">        <span class="keyword">HAVING</span> <span class="keyword">SUM</span>(priceEach * quantityOrdered) &gt; <span class="number">60000</span>);</div></pre></td></tr></table></figure>
<h3 id="MySQL派生表"><a href="#MySQL派生表" class="headerlink" title="MySQL派生表"></a>MySQL派生表</h3><p>派生表是从SELECT语句返回的虚拟表。派生表类似于临时表，但是在SELECT语句中使用派生表比临时表简单得多，因为它不需要创建临时表的步骤。</p>
<p>派生表和子查询通常可互换使用。<strong>当SELECT语句的FROM子句中使用独立子查询时，我们将其称为派生表。</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> </div><div class="line">    column_list</div><div class="line"><span class="keyword">FROM</span></div><div class="line">    (<span class="keyword">SELECT</span> </div><div class="line">        column_list</div><div class="line">    <span class="keyword">FROM</span></div><div class="line">        table_1) derived_table_name;</div><div class="line">WHERE derived_table_name.c1 &gt; 0;</div></pre></td></tr></table></figure>
<h3 id="MySQL-公共表达式-CTE"><a href="#MySQL-公共表达式-CTE" class="headerlink" title="MySQL 公共表达式(CTE)"></a>MySQL 公共表达式(CTE)</h3><h3 id="INTERSECT"><a href="#INTERSECT" class="headerlink" title="INTERSECT"></a>INTERSECT</h3><p>INTERSECT 是一个集合运算符，它只返回两个查询或更多查询的交集</p>
<blockquote>
<p>要将INTERSECT用于两个查询集，需要 1.列的顺序和数量必须相同 2.相应列的数据类型必须兼容或可转换。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">SELECT</span> column_list </div><div class="line"><span class="keyword">FROM</span> table_1)</div><div class="line"><span class="keyword">INTERSECT</span></div><div class="line">(<span class="keyword">SELECT</span> column_list</div><div class="line"><span class="keyword">FROM</span> table_2);</div></pre></td></tr></table></figure>
<blockquote>
<p>注意:SQL标准有三个集合运算符，包括UNION，INTERSECT和MINUS  分别是取并交减</p>
</blockquote>
<p>MySQL不支持INTERSECT操作符。 但是我们可以模拟INTERSECT操作符。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> </div><div class="line">   <span class="keyword">id</span> </div><div class="line"><span class="keyword">FROM</span> t1</div><div class="line">   <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t2 <span class="keyword">USING</span>(<span class="keyword">id</span>);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></div><div class="line">    <span class="keyword">id</span></div><div class="line"><span class="keyword">FROM</span></div><div class="line">    t1</div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    <span class="keyword">id</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> </div><div class="line">            <span class="keyword">id</span></div><div class="line">        <span class="keyword">FROM</span></div><div class="line">            t2);</div></pre></td></tr></table></figure>
<h2 id="MySQL事务"><a href="#MySQL事务" class="headerlink" title="MySQL事务"></a>MySQL事务</h2><p>事务是一组数据库指令所组成的一个处理单元，其中数据库的任意一条指令失败，则事务失败，事务是模块化的指令集合。用以完成某个特定任务。</p>
<p>事务具有以下四个标准属性，通常由首字母缩写ACID简称</p>
<ul>
<li>原子性: 确保了工作单位中的所有操作都成功完成; 否则，事务被中止，在失败时会被回滚到事务操作以前的状态。</li>
<li>一致性：可确保数据库在正确的更改状态在一个成功提交事务。</li>
<li>隔离: 使事务相互独立地操作。</li>
<li>持久性: 确保了提交事务的结果或系统故障情况下仍然存在作用。</li>
</ul>
<p>在MySQL中，事务以BEGIN WORK语句开始开始工作，并使用COMMIT或ROLLBACK语句结束。SQL命令在开始和结束语句之间构成大量事务。</p>
<ul>
<li>当一个成功的事务完成后，COMMIT命令发出的变化对所有涉及的表将生效。</li>
<li>如果发生故障，ROLLBACK命令发出后，事务中引用的每个表将恢复到事务开始之前的状态。</li>
</ul>
<p>当AUTOCOMMIT = 1(默认值)，则每一次SQL语句都被认为是一个完整的事务并提交。当AUTOCOMMIT设置为0，通过发出SET AUTOCOMMIT=0命令, 随后的一系列语句就像一个事务，直到一个明确的发出 COMMIT 语句，更改才被记录进数据库。</p>
<p>如果需要在MySQL中直接使用事务，则需要在lnnoDB类型的表上进行操作。创建lnnoDB类型的表如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; create table tcount_tbl</div><div class="line">    -&gt; (</div><div class="line">    -&gt; tutorial_author varchar(40) NOT NULL,</div><div class="line">    -&gt; tutorial_count  INT</div><div class="line">    -&gt; ) TYPE=InnoDB;</div><div class="line">Query OK, 0 rows affected (0.05 sec)</div></pre></td></tr></table></figure>
<p>以下是关于一个事务的例子</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- start a new transaction</span></div><div class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</div><div class="line"></div><div class="line"><span class="comment">-- get latest order number</span></div><div class="line"><span class="keyword">select</span> @orderNumber := <span class="keyword">max</span>(orderNUmber) </div><div class="line"><span class="keyword">from</span> orders;</div><div class="line"><span class="comment">-- set new order number</span></div><div class="line"><span class="keyword">set</span> @orderNumber = @orderNumber  + <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="comment">-- insert a new order for customer 145</span></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders(orderNumber,</div><div class="line">                   orderDate,</div><div class="line">                   requiredDate,</div><div class="line">                   shippedDate,</div><div class="line">                   <span class="keyword">status</span>,</div><div class="line">                   customerNumber)</div><div class="line"><span class="keyword">values</span>(@orderNumber,</div><div class="line">       <span class="keyword">now</span>(),</div><div class="line">       <span class="keyword">date_add</span>(<span class="keyword">now</span>(), <span class="built_in">INTERVAL</span> <span class="number">5</span> <span class="keyword">DAY</span>),</div><div class="line">       <span class="keyword">date_add</span>(<span class="keyword">now</span>(), <span class="built_in">INTERVAL</span> <span class="number">2</span> <span class="keyword">DAY</span>),</div><div class="line">       <span class="string">'In Process'</span>,</div><div class="line">        <span class="number">145</span>);</div><div class="line"><span class="comment">-- insert 2 order line items</span></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orderdetails(orderNumber,</div><div class="line">                         productCode,</div><div class="line">                         quantityOrdered,</div><div class="line">                         priceEach,</div><div class="line">                         orderLineNumber)</div><div class="line"><span class="keyword">values</span>(@orderNumber,<span class="string">'S18_1749'</span>, <span class="number">30</span>, <span class="string">'136'</span>, <span class="number">1</span>),</div><div class="line">      (@orderNumber,<span class="string">'S18_2248'</span>, <span class="number">50</span>, <span class="string">'55.09'</span>, <span class="number">2</span>); </div><div class="line"><span class="comment">-- commit changes    </span></div><div class="line"><span class="keyword">commit</span>;       </div><div class="line"></div><div class="line"><span class="comment">-- get the new inserted order</span></div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> orders a </div><div class="line"><span class="keyword">inner</span> <span class="keyword">join</span> orderdetails b <span class="keyword">on</span> a.ordernumber = b.ordernumber</div><div class="line"><span class="keyword">where</span> a.ordernumber = @ordernumber;</div></pre></td></tr></table></figure>
<p>表锁为WRITE具有以下功能：</p>
<ul>
<li>只有拥有表锁定的会话才能从表读取和写入数据。</li>
<li>在释放WRITE锁之前，其他会话不能从表中读写。</li>
</ul>
<h2 id="MySQL-Alter增建和删除列"><a href="#MySQL-Alter增建和删除列" class="headerlink" title="MySQL Alter增建和删除列"></a>MySQL Alter增建和删除列</h2><p>首先我们创建一个表testalter_tb1,其中有column i,c</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">mysql&gt; create table testalter_tbl</div><div class="line">    -&gt; (</div><div class="line">    -&gt; i INT,</div><div class="line">    -&gt; c CHAR(1)</div><div class="line">    -&gt; );</div><div class="line">Query OK, 0 rows affected (0.05 sec)</div><div class="line">mysql&gt; SHOW COLUMNS FROM testalter_tbl;</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">| Field | Type    | Null | Key | Default | Extra |</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">| i     | int(11) | YES  |     | NULL    |       |</div><div class="line">| c     | char(1) | YES  |     | NULL    |       |</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div><div class="line"></div><div class="line"># 删除列i</div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl  <span class="keyword">DROP</span> i;</div><div class="line"></div><div class="line"># 增建列i</div><div class="line"></div><div class="line">mysql&gt; ALTER TABLE testalter_tbl ADD i INT;</div><div class="line"></div><div class="line"># 我们可以以FIRST参数或AFTER column_name 来指定新增加列的排序位置</div><div class="line"></div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">ADD</span> i <span class="built_in">INT</span> <span class="keyword">FIRST</span>;</div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">ADD</span> i <span class="built_in">INT</span> <span class="keyword">AFTER</span> c;</div><div class="line"></div><div class="line"># 使用MODIFY参数或CHANGE子句用以改变列定义、</div><div class="line">1.将c从CHAR(1)改为CHAR(10) 2.将i改名为j，类型为BIGINT。 3.更改某列类型，且默认值为100</div><div class="line">mysql&gt; ALTER TABLE testalter_tbl MODIFY c CHAR(10);</div><div class="line"></div><div class="line">mysql&gt; ALTER TABLE testalter_tbl CHANGE i j BIGINT;</div><div class="line"></div><div class="line">mysql&gt; ALTER TABLE testalter_tbl CHANGE j j INT NOT NULL DEFAULT 100;</div></pre></td></tr></table></figure>
<p>我们也可以使用ALTER命令更改任何列的默认值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">mysql&gt; ALTER TABLE testalter_tbl ALTER i SET DEFAULT 1000;</div><div class="line">mysql&gt; SHOW COLUMNS FROM testalter_tbl;</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">| Field | Type    | Null | Key | Default | Extra |</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">| c     | char(1) | YES  |     | NULL    |       |</div><div class="line">| i     | int(11) | YES  |     | 1000    |       |</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">ALTER</span> i <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span>;</div><div class="line">mysql&gt; SHOW COLUMNS FROM testalter_tbl;</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">| Field | Type    | Null | Key | Default | Extra |</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">| c     | char(1) | YES  |     | NULL    |       |</div><div class="line">| i     | int(11) | YES  |     | NULL    |       |</div><div class="line">+<span class="comment">-------+---------+------+-----+---------+-------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure>
<p>ALTER也可以修改表的类型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; ALTER TABLE testalter_tbl TYPE = MYISAM;</div><div class="line">mysql&gt;  SHOW TABLE STATUS LIKE 'testalter_tbl'\G</div><div class="line">*************************** 1. row ****************</div><div class="line">           Name: testalter_tbl</div><div class="line">           Type: MyISAM</div><div class="line">           ...</div><div class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure>
<p>ALTER重命名表</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; ALTER TABLE testalter_tbl RENAME TO alter_tbl;</div></pre></td></tr></table></figure>
<h2 id="MySQL索引"><a href="#MySQL索引" class="headerlink" title="MySQL索引"></a>MySQL索引</h2><p>要创建索引，可以使用CREATE INDEX语句。 下面说明了CREATE INDEX语句的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span>|FULLTEXT|SPATIAL] <span class="keyword">INDEX</span> index_name</div><div class="line"><span class="keyword">USING</span> [BTREE | <span class="keyword">HASH</span> | RTREE] </div><div class="line"><span class="keyword">ON</span> table_name (column_name [(<span class="keyword">length</span>)] [<span class="keyword">ASC</span> | <span class="keyword">DESC</span>],...)</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_officeCode <span class="keyword">ON</span> employees(officeCode)</div><div class="line"></div><div class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_name <span class="keyword">ON</span> table_name</div></pre></td></tr></table></figure>
<ul>
<li>对于UNIQUE索引，MySQL创建一个约束，索引中的所有值都必须是唯一的。除了BDB之外，所有存储引擎都允许重复的NULL值。</li>
<li>FULLTEXT索引仅由MyISAM存储引擎支持，仅在数据类型为CHAR，VARCHAR或TEXT的列中接受。</li>
<li>SPATIAL索引支持空间列，可用于MyISAM存储引擎。另外，列值不能为NULL。</li>
</ul>
<h2 id="MySQL-约束"><a href="#MySQL-约束" class="headerlink" title="MySQL 约束"></a>MySQL 约束</h2><h3 id="NOT-NULL约束"><a href="#NOT-NULL约束" class="headerlink" title="NOT NULL约束"></a>NOT NULL约束</h3><p>NOT NULL约束是一个列约束，仅将列的值强制为非NULL值。</p>
<p>NOT NULL约束的语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">column_name data_type NOT NULL;</div></pre></td></tr></table></figure>
<p><strong>创建表时指定NOT NULL</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">USE</span> testdb;</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tasks (</div><div class="line">    <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span>,</div><div class="line">    title <span class="built_in">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">    start_date <span class="built_in">DATE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">    end_date <span class="built_in">DATE</span></div><div class="line">);</div></pre></td></tr></table></figure>
<p><strong>向现有列添加NOT NULL约束</strong></p>
<ul>
<li>检查列的当前值。</li>
<li>将所有NULL值更新为非NULL值。</li>
<li>添加NOT NULL约束</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> tasks </div><div class="line"><span class="keyword">SET</span> </div><div class="line">    end_date = start_date + <span class="number">7</span></div><div class="line"><span class="keyword">WHERE</span></div><div class="line">    end_date <span class="keyword">IS</span> <span class="literal">NULL</span>;</div><div class="line"></div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name</div><div class="line"><span class="keyword">CHANGE</span> old_column_name new_column_name new_column_definition;</div></pre></td></tr></table></figure>
<h2 id="MySQL-临时表"><a href="#MySQL-临时表" class="headerlink" title="MySQL 临时表"></a>MySQL 临时表</h2><p>临时表功能在MySQL 3.23版本以后才有<br>临时表特点：当前客户端会话结束时，它们将会被删除。</p>
<p>下面的例子中，首先创建一个临时表，然后插入一个数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">mysql&gt; CREATE TEMPORARY TABLE SalesSummary (</div><div class="line">    -&gt; product_name VARCHAR(50) NOT NULL</div><div class="line">    -&gt; , total_sales DECIMAL(12,2) NOT NULL DEFAULT 0.00</div><div class="line">    -&gt; , avg_unit_price DECIMAL(7,2) NOT NULL DEFAULT 0.00</div><div class="line">    -&gt; , total_units_sold INT UNSIGNED NOT NULL DEFAULT 0</div><div class="line">);</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; INSERT INTO SalesSummary</div><div class="line">    -&gt; (product_name, total_sales, avg_unit_price, total_units_sold)</div><div class="line">    -&gt; VALUES</div><div class="line">    -&gt; ('cucumber', 100.25, 90, 2);</div><div class="line"></div><div class="line">mysql&gt; SELECT * FROM SalesSummary;</div><div class="line">+<span class="comment">--------------+-------------+----------------+------------------+</span></div><div class="line">| product_name | total_sales | avg_unit_price | total_units_sold |</div><div class="line">+<span class="comment">--------------+-------------+----------------+------------------+</span></div><div class="line">| cucumber     |      100.25 |          90.00 |                2 |</div><div class="line">+<span class="comment">--------------+-------------+----------------+------------------+</span></div><div class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure>
<p>当发出SHOW TABLES命令，临时表不会被列在表的列表中。现在，如果注销MySQL会话，然后发出SELECT命令，那么会发现在数据库中没有可用的数据。即使是临时表也不存在了。</p>
<p>删除临时表与正常表同理，没有区别。</p>
<h2 id="MySQL复制表"><a href="#MySQL复制表" class="headerlink" title="MySQL复制表"></a>MySQL复制表</h2><p>当需要一个表的精确副本时，可以通过以下步骤处理</p>
<ul>
<li>使用SHOW CREATE TABLE以获得CREATE TABLE语句用于指定源表的结构，索引和其它事项</li>
<li>修改语句用来更改表名，以克隆出一个表的框架</li>
<li>如果需要复制表的内容，再发出一个INSERT INTO … SELECT</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">#1.获取有关表的完整结构</div><div class="line">mysql&gt; SHOW CREATE TABLE tutorials_tbl \G;</div><div class="line">*************************** 1. row ***************************</div><div class="line">       Table: tutorials_tbl</div><div class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tutorials_tbl`</span> (</div><div class="line">  <span class="string">`tutorial_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> auto_increment,</div><div class="line">  <span class="string">`tutorial_title`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">default</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`tutorial_author`</span> <span class="built_in">varchar</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">default</span> <span class="string">''</span>,</div><div class="line">  <span class="string">`submission_date`</span> <span class="built_in">date</span> <span class="keyword">default</span> <span class="literal">NULL</span>,</div><div class="line">  PRIMARY <span class="keyword">KEY</span>  (<span class="string">`tutorial_id`</span>),</div><div class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`AUTHOR_INDEX`</span> (<span class="string">`tutorial_author`</span>)</div><div class="line">) <span class="keyword">TYPE</span>=MyISAM</div><div class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div><div class="line"></div><div class="line">#<span class="number">2.</span>重命名该表，并创建另一个表</div><div class="line">mysql&gt; <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`clone_tbl`</span> (</div><div class="line">  -&gt; <span class="string">`tutorial_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> auto_increment,</div><div class="line">  -&gt; <span class="string">`tutorial_title`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">default</span> <span class="string">''</span>,</div><div class="line">  -&gt; <span class="string">`tutorial_author`</span> <span class="built_in">varchar</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">default</span> <span class="string">''</span>,</div><div class="line">  -&gt; <span class="string">`submission_date`</span> <span class="built_in">date</span> <span class="keyword">default</span> <span class="literal">NULL</span>,</div><div class="line">  -&gt; PRIMARY <span class="keyword">KEY</span>  (<span class="string">`tutorial_id`</span>),</div><div class="line">  -&gt; <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`AUTHOR_INDEX`</span> (<span class="string">`tutorial_author`</span>)</div><div class="line">-&gt; ) <span class="keyword">TYPE</span>=MyISAM;</div><div class="line">Query OK, 0 rows affected (1.80 sec)</div><div class="line"></div><div class="line">#3.使用INSERT INTO... SELECT将旧数据转入新数据</div><div class="line">mysql&gt; INSERT INTO clone_tbl (tutorial_id,</div><div class="line">    -&gt;                        tutorial_title,</div><div class="line">    -&gt;                        tutorial_author,</div><div class="line">    -&gt;                        submission_date)</div><div class="line">    -&gt; SELECT tutorial_id,tutorial_title,</div><div class="line">    -&gt;        tutorial_author,submission_date,</div><div class="line">    -&gt; FROM tutorials_tbl;</div><div class="line">Query OK, 3 rows affected (0.07 sec)</div><div class="line">Records: 3  Duplicates: 0  Warnings: 0</div></pre></td></tr></table></figure>
<h2 id="MySQL数据库信息"><a href="#MySQL数据库信息" class="headerlink" title="MySQL数据库信息"></a>MySQL数据库信息</h2><p> 有三个信息，经常要从MySQL获取。</p>
<ul>
<li>有关查询结果的信息: 这包括任何SELECT，UPDATE或DELETE语句所影响的记录数量。</li>
<li>有关表和数据库的信息: 这包括关于表和数据库的结构的信息。</li>
<li>关于MySQL服务器的信息: 这包括数据库服务器的当前状态，版本号等。</li>
</ul>
<h2 id="MySQL重复处理"><a href="#MySQL重复处理" class="headerlink" title="MySQL重复处理"></a>MySQL重复处理</h2><ol>
<li>防止在一个表发生重复记录</li>
</ol>
<blockquote>
<p>方式：指定一个主键PRIMARY KEY</p>
</blockquote>
<p>下方第一个是会产生重复记录的表，第二个是不会产生重复记录的表，如果插入重复记录，则会报错</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person_tbl</div><div class="line">(</div><div class="line">    first_name <span class="built_in">CHAR</span>(<span class="number">20</span>),</div><div class="line">    last_name <span class="built_in">CHAR</span>(<span class="number">20</span>),</div><div class="line">    sex <span class="built_in">CHAR</span>(<span class="number">10</span>)</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person_tbl</div><div class="line">(</div><div class="line">   first_name <span class="built_in">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">   last_name <span class="built_in">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">   sex <span class="built_in">CHAR</span>(<span class="number">10</span>),</div><div class="line">   PRIMARY <span class="keyword">KEY</span> (last_name, first_name)</div><div class="line">);</div></pre></td></tr></table></figure>
<p>如果使用INSERT IGNORE 而非INSERT，当插入重复观测时则不会报错，只是丢弃</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; INSERT IGNORE INTO person_tbl (last_name, first_name)</div><div class="line">    -&gt; VALUES( 'Jay', 'Thomas');</div><div class="line">Query OK, 1 row affected (0.00 sec)</div><div class="line">mysql&gt; INSERT IGNORE INTO person_tbl (last_name, first_name)</div><div class="line">    -&gt; VALUES( 'Jay', 'Thomas');</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure>
<p>当使用REPLACE 而非 INSERT，当插入新的记录则会记录，插入旧的记录，则会更新</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; REPLACE INTO person_tbl (last_name, first_name)</div><div class="line">    -&gt; VALUES( 'Ajay', 'Kumar');</div><div class="line">Query OK, 1 row affected (0.00 sec)</div><div class="line">mysql&gt; REPLACE INTO person_tbl (last_name, first_name)</div><div class="line">    -&gt; VALUES( 'Ajay', 'Kumar');</div><div class="line">Query OK, 2 rows affected (0.00 sec)</div></pre></td></tr></table></figure>
<ol>
<li>统计和标识重复</li>
</ol>
<p>以下是查询以统计first_name和last_name 在表中的重复记录数。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">mysql&gt; SELECT COUNT(*) as repetitions, last_name, first_name</div><div class="line">    -&gt; FROM person_tbl</div><div class="line">    -&gt; GROUP BY last_name, first_name</div><div class="line">    -&gt; HAVING repetitions &gt; 1;</div></pre></td></tr></table></figure>
<ol>
<li>删除重复</li>
</ol>
<p>3.1 创建新表再重命名回去</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mysql&gt; CREATE TABLE tmp SELECT last_name, first_name, sex</div><div class="line">    -&gt;                  FROM person_tbl;</div><div class="line">    -&gt;                  GROUP BY (last_name, first_name);</div><div class="line">mysql&gt; DROP TABLE person_tbl;</div><div class="line">mysql&gt; ALTER TABLE tmp RENAME TO person_tbl;</div></pre></td></tr></table></figure>
<p>3.2 以添加主键的方式去除重复记录</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; ALTER IGNORE TABLE person_tbl</div><div class="line">    -&gt; ADD PRIMARY KEY (last_name, first_name);</div></pre></td></tr></table></figure>
<h2 id="MySQL数据库导出"><a href="#MySQL数据库导出" class="headerlink" title="MySQL数据库导出"></a>MySQL数据库导出</h2><ol>
<li>SELECT … INTO OUTFILE</li>
</ol>
<p>常规语法将导出到txt，并使用制表符分割，换行符结尾。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT * FROM tutorials_tbl </div><div class="line">    -&gt; INTO OUTFILE 'C:\tutorials.txt';</div></pre></td></tr></table></figure>
<p>也可以利用选项更改记录的输出格式。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT * FROM passwd INTO OUTFILE 'C:\tutorials.txt'</div><div class="line">    -&gt; FIELDS TERMINATED BY ',' ENCLOSED BY '"'</div><div class="line">    -&gt; LINES TERMINATED BY '\r\n';</div></pre></td></tr></table></figure>
<p>导出表作为原始数据，使用mysqldump，它可以写入表输出作为一个原始数据文件，或为一组重新创建表中的INSERT语句的记录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ mysqldump -u root -p --no-create-info \</div><div class="line">            --tab=c:\tmp TEST tutorials_tbl</div><div class="line">password ******</div></pre></td></tr></table></figure>
<p>以SQL格式的表导出到一个文件，使用如下方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mysqldump -u root -p test tutorials_tbl &gt; dump.txt</div><div class="line">password ******</div></pre></td></tr></table></figure>
<p>要转储多个表，所有数据库名称参数后跟它们的名字。要转储整个数据库，不需要在数据库之后命名(附加)任何表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mysqldump -u root -p test &gt; database_dump.txt</div><div class="line">password ******</div></pre></td></tr></table></figure>
<p>要备份所有可用的数据库在主机上，使用以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mysqldump -u root -p --all-databases &gt; database_dump.txt</div><div class="line">password ******</div></pre></td></tr></table></figure>
<p>复制表或数据库到另一台主机</p>
<p>可以使用mysql命令将之前导出的txt文件再读入，运行此命令之前，请确保已创建数据库名称在目标服务器上。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mysql -u root -p database_name &lt; dump.txt</div><div class="line">password *****</div></pre></td></tr></table></figure>
<p>另一种方式来实现这一点，无需使用一个中间文件是来发送，mysqldump输出直接通过网络到远程MySQL服务器。如果可以从源数据库所在的主机那里连接两个服务器，使用此命令(请确保两个服务器可以访问)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mysqldump -u root -p database_name \</div><div class="line">       | mysql -h other-host.com database_name</div></pre></td></tr></table></figure>
<h2 id="MySQL数据库导入"><a href="#MySQL数据库导入" class="headerlink" title="MySQL数据库导入"></a>MySQL数据库导入</h2><h3 id="LOAD-DATA"><a href="#LOAD-DATA" class="headerlink" title="LOAD DATA"></a>LOAD DATA</h3><p>读取默认文件，默认情况下，LOAD DATA假设数据文件包含一个行由制表符分隔范围内被换行(新行)分割行和数据值。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; LOAD DATA LOCAL INFILE 'C:\dump.txt' INTO TABLE mytbl;</div></pre></td></tr></table></figure>
<p>可以使用FIELDS子句描述一行内字段的特征，LINES子句指定的行结束序列。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mysql&gt; LOAD DATA LOCAL INFILE 'C:\dump.txt' INTO TABLE mytbl</div><div class="line">  -&gt; FIELDS TERMINATED BY ':'</div><div class="line">  -&gt; LINES TERMINATED BY '\r\n';</div></pre></td></tr></table></figure>
<p>LOAD DATA假定数据文件中的列具有相同的顺序在表中的列。如果不是这样，可以指定一个列表来指示哪些表列数据文件列应该被装入。 假设表中的列A，B和C，但在数据文件连续列对应于列B，C，和A。可以像这样加载文件：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; LOAD DATA LOCAL INFILE 'dump.txt' </div><div class="line">    -&gt; INTO TABLE mytbl (b, c, a);</div></pre></td></tr></table></figure>
<h3 id="mysqlimport导入数据"><a href="#mysqlimport导入数据" class="headerlink" title="mysqlimport导入数据"></a>mysqlimport导入数据</h3><p>mysqlimport命令是一个命令行工具，包装了LOAD DATA</p>
<p>从dump.txt加载数据到表mytbl，使用下面的命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ mysqlimport -u root -p --local database_name dump.txt</div><div class="line">password *****</div></pre></td></tr></table></figure>
<p>使用–fields-terminated-by参数和–lines-terminated-by参数来指定分割符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ mysqlimport -u root -p --local --fields-terminated-by=&quot;:&quot; \</div><div class="line">   --lines-terminated-by=&quot;\r\n&quot;  database_name dump.txt</div><div class="line">password *****</div></pre></td></tr></table></figure>
<p>使用–columns参数来指定列的顺序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ mysqlimport -u root -p --local --columns=b,c,a \</div><div class="line">    database_name dump.txt</div><div class="line">password *****</div></pre></td></tr></table></figure>
<p>处理引号和特殊字符</p>
<p> 除了TERMINATED，FIELDS子句可以指定其他格式选项。默认情况下，LOAD DATA假设值是加引号的，并解释反斜线()作为特殊字符转义字符。要明确注明引用字符值， 使用ENCLOSED BY; MySQL将剥离字符的数据值末端在输入处理期间。要更改默认的转义字符，可使用ESCAPED BY。</p>
<p>当指定ENCLOSED BY，表明引号字符应该从数据值被剥离，有可能通过加一次或通过转义字符，确实包含引号字符在数据值前。例如，如果引号和转义字符是” 和 \，输入 “a””b\”c” 将被解释为：a”b”c</p>
<p>对于 mysqlimport，相应的命令行选项引号和转义值是通过 –fields-enclosed-by 和 –fields-escaped-by来指定。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/速查/" rel="tag"># 速查</a>
          
            <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          
            <a href="/tags/笔记/" rel="tag"># 笔记</a>
          
            <a href="/tags/数据库/" rel="tag"># 数据库</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/编程/Linux-速查笔记/" rel="next" title="Linux-速查笔记">
                <i class="fa fa-chevron-left"></i> Linux-速查笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/编程/MySQL-细节与小结/" rel="prev" title="MySQL-细节与小结：存储过程与视图">
                MySQL-细节与小结：存储过程与视图 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/timeaftertime.jpg"
                alt="Snowman" />
            
              <p class="site-author-name" itemprop="name">Snowman</p>
              <p class="site-description motion-element" itemprop="description">Time After Time</p>
          </div>
          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">35</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">58</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#系统操作"><span class="nav-number">1.</span> <span class="nav-text">系统操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#在DOS环境下设置root密码"><span class="nav-number">1.1.</span> <span class="nav-text">在DOS环境下设置root密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#登录"><span class="nav-number">1.2.</span> <span class="nav-text">登录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关闭服务"><span class="nav-number">1.3.</span> <span class="nav-text">关闭服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#验证版本"><span class="nav-number">1.4.</span> <span class="nav-text">验证版本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#管理操作"><span class="nav-number">2.</span> <span class="nav-text">管理操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#设置MySQL用户账户"><span class="nav-number">2.1.</span> <span class="nav-text">设置MySQL用户账户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建数据库"><span class="nav-number">2.2.</span> <span class="nav-text">创建数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除数据库"><span class="nav-number">2.3.</span> <span class="nav-text">删除数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#另一种创建用户的方式-GRANT"><span class="nav-number">2.3.1.</span> <span class="nav-text">另一种创建用户的方式 GRANT</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一些常用的查看操作"><span class="nav-number">2.4.</span> <span class="nav-text">一些常用的查看操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表字段类型"><span class="nav-number">3.</span> <span class="nav-text">表字段类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查询表"><span class="nav-number">4.</span> <span class="nav-text">查询表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DISTINCE-和-GROUP-BY比较"><span class="nav-number">4.1.</span> <span class="nav-text">DISTINCE 和 GROUP BY比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DISTINCT和聚合函数"><span class="nav-number">4.2.</span> <span class="nav-text">DISTINCT和聚合函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DISTINCT-与-LIMIT子句"><span class="nav-number">4.3.</span> <span class="nav-text">DISTINCT 与 LIMIT子句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建、删除及插入表"><span class="nav-number">5.</span> <span class="nav-text">创建、删除及插入表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT"><span class="nav-number">6.</span> <span class="nav-text">INSERT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#INSERT-…-SELECT"><span class="nav-number">6.1.</span> <span class="nav-text">INSERT … SELECT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#INSERT与ON-DUPLICATE-KEY-UPDATE"><span class="nav-number">6.2.</span> <span class="nav-text">INSERT与ON DUPLICATE KEY UPDATE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-扩展：-IGNORE"><span class="nav-number">6.3.</span> <span class="nav-text">MySQL 扩展： IGNORE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPDATE"><span class="nav-number">7.</span> <span class="nav-text">UPDATE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UPDATE-与-SELECT-结合"><span class="nav-number">7.1.</span> <span class="nav-text">UPDATE 与 SELECT 结合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UPDATE-跨表更新-INNER-JOIN子句和LEFT-JOIN子句"><span class="nav-number">7.2.</span> <span class="nav-text">UPDATE 跨表更新(INNER JOIN子句和LEFT JOIN子句)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DELETE"><span class="nav-number">8.</span> <span class="nav-text">DELETE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE-与-INNER-JOIN"><span class="nav-number">8.1.</span> <span class="nav-text">DELETE 与 INNER JOIN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE-与-LEFT-JOIN"><span class="nav-number">8.2.</span> <span class="nav-text">DELETE 与 LEFT JOIN</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REPLACE"><span class="nav-number">9.</span> <span class="nav-text">REPLACE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#REPLACE第一种形式"><span class="nav-number">9.1.</span> <span class="nav-text">REPLACE第一种形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#REPLACE第二种形式"><span class="nav-number">9.2.</span> <span class="nav-text">REPLACE第二种形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#REPLACE第三种形式"><span class="nav-number">9.3.</span> <span class="nav-text">REPLACE第三种形式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PREPARED"><span class="nav-number">10.</span> <span class="nav-text">PREPARED</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WHERE及子操作符IN-BETWEEN-LIKE"><span class="nav-number">11.</span> <span class="nav-text">WHERE及子操作符IN BETWEEN LIKE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AND-OR"><span class="nav-number">11.1.</span> <span class="nav-text">AND OR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IN"><span class="nav-number">11.2.</span> <span class="nav-text">IN</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IN-与子查询"><span class="nav-number">11.2.1.</span> <span class="nav-text">IN 与子查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BETWEEN-运算符"><span class="nav-number">11.3.</span> <span class="nav-text">BETWEEN 运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BETWEEN-和-日期类型数据"><span class="nav-number">11.3.1.</span> <span class="nav-text">BETWEEN 和 日期类型数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LIKE"><span class="nav-number">11.4.</span> <span class="nav-text">LIKE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#LIKE-与-ESCAPE-子句"><span class="nav-number">11.4.1.</span> <span class="nav-text">LIKE 与 ESCAPE 子句</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LIMIT"><span class="nav-number">11.5.</span> <span class="nav-text">LIMIT</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#LIMIT-与-ORDER-BY-混用"><span class="nav-number">11.5.1.</span> <span class="nav-text">LIMIT 与 ORDER BY 混用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ORDER-BY"><span class="nav-number">12.</span> <span class="nav-text">ORDER BY</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ORDER-BY-允许对结果集根据表达式进行排序"><span class="nav-number">12.0.1.</span> <span class="nav-text">ORDER BY 允许对结果集根据表达式进行排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ORDER-BY-与自定义排序"><span class="nav-number">12.0.2.</span> <span class="nav-text">ORDER BY 与自定义排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ORDER-BY-与自然排序"><span class="nav-number">12.0.3.</span> <span class="nav-text">ORDER BY 与自然排序</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPDATE语法"><span class="nav-number">13.</span> <span class="nav-text">UPDATE语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DELETE语法"><span class="nav-number">14.</span> <span class="nav-text">DELETE语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ORDER-BY将查询结果排序"><span class="nav-number">15.</span> <span class="nav-text">ORDER BY将查询结果排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Join联接"><span class="nav-number">16.</span> <span class="nav-text">Join联接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#如何处理NULL值查询？"><span class="nav-number">16.1.</span> <span class="nav-text">如何处理NULL值查询？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL正则表达式"><span class="nav-number">17.</span> <span class="nav-text">MySQL正则表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL连接表"><span class="nav-number">18.</span> <span class="nav-text">MySQL连接表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#列别名"><span class="nav-number">18.1.</span> <span class="nav-text">列别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#表别名"><span class="nav-number">18.2.</span> <span class="nav-text">表别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内连接-INNER-JOIN"><span class="nav-number">18.3.</span> <span class="nav-text">内连接 INNER JOIN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#左连接"><span class="nav-number">18.4.</span> <span class="nav-text">左连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CROSS-JOIN"><span class="nav-number">18.5.</span> <span class="nav-text">CROSS JOIN</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分组数据"><span class="nav-number">19.</span> <span class="nav-text">分组数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GROUP-BY"><span class="nav-number">19.1.</span> <span class="nav-text">GROUP BY</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GROUP-BY-与聚合函数"><span class="nav-number">19.2.</span> <span class="nav-text">GROUP BY 与聚合函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GROUP-BY-用表达式示例"><span class="nav-number">19.3.</span> <span class="nav-text">GROUP BY 用表达式示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GROUP-BY-与-HAVING"><span class="nav-number">19.4.</span> <span class="nav-text">GROUP BY 与 HAVING</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GROUP-BY-与标准SQL"><span class="nav-number">19.5.</span> <span class="nav-text">GROUP BY 与标准SQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HAVING"><span class="nav-number">19.6.</span> <span class="nav-text">HAVING</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL子查询，派生表和通用表达式"><span class="nav-number">20.</span> <span class="nav-text">MySQL子查询，派生表和通用表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL子查询"><span class="nav-number">20.1.</span> <span class="nav-text">MySQL子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FROM子句中的子查询"><span class="nav-number">20.2.</span> <span class="nav-text">FROM子句中的子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL相关子查询"><span class="nav-number">20.3.</span> <span class="nav-text">MySQL相关子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL子查询与EXISTS和NOT-EXISTS"><span class="nav-number">20.4.</span> <span class="nav-text">MySQL子查询与EXISTS和NOT EXISTS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL派生表"><span class="nav-number">20.5.</span> <span class="nav-text">MySQL派生表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-公共表达式-CTE"><span class="nav-number">20.6.</span> <span class="nav-text">MySQL 公共表达式(CTE)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#INTERSECT"><span class="nav-number">20.7.</span> <span class="nav-text">INTERSECT</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL事务"><span class="nav-number">21.</span> <span class="nav-text">MySQL事务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-Alter增建和删除列"><span class="nav-number">22.</span> <span class="nav-text">MySQL Alter增建和删除列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL索引"><span class="nav-number">23.</span> <span class="nav-text">MySQL索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-约束"><span class="nav-number">24.</span> <span class="nav-text">MySQL 约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NOT-NULL约束"><span class="nav-number">24.1.</span> <span class="nav-text">NOT NULL约束</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-临时表"><span class="nav-number">25.</span> <span class="nav-text">MySQL 临时表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL复制表"><span class="nav-number">26.</span> <span class="nav-text">MySQL复制表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL数据库信息"><span class="nav-number">27.</span> <span class="nav-text">MySQL数据库信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL重复处理"><span class="nav-number">28.</span> <span class="nav-text">MySQL重复处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL数据库导出"><span class="nav-number">29.</span> <span class="nav-text">MySQL数据库导出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL数据库导入"><span class="nav-number">30.</span> <span class="nav-text">MySQL数据库导入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LOAD-DATA"><span class="nav-number">30.1.</span> <span class="nav-text">LOAD DATA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysqlimport导入数据"><span class="nav-number">30.2.</span> <span class="nav-text">mysqlimport导入数据</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Snowman</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>








        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

</body>
</html>
